<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>meiji163</title>
    <link>https://meiji163.github.io/</link>
    <description>Recent content on meiji163</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>en</language>
    <lastBuildDate>Thu, 02 Nov 2023 00:00:00 +0000</lastBuildDate>
    
        <atom:link href="https://meiji163.github.io/index.xml" rel="self" type="application/rss+xml" />
    
    
    <item>
      <title>Error Correcting Codes: Part 1</title>
      <link>https://meiji163.github.io/post/ecc/</link>
      <pubDate>Thu, 02 Nov 2023 00:00:00 +0000</pubDate>
      
      <guid>https://meiji163.github.io/post/ecc/</guid>
      
        <description>&lt;blockquote&gt;
&lt;p&gt;&amp;ldquo;There is geometry in the humming of the strings, there is music in the spacing of the spheres.&amp;rdquo;&lt;/p&gt;
&lt;p&gt;&amp;ndash; Pythagoras&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&#34;introduction&#34;&gt;Introduction&lt;/h2&gt;
&lt;p&gt;Recently I started exploring the world of error-correcting codes, and algebraic codes in particular.
It&amp;rsquo;s a perfect example of &lt;a href=&#34;https://www.evanmiller.org/mathematical-hacker.html&#34;&gt;mathematical hacking&lt;/a&gt;, where the Platonic realm of mathematical objects collides with the concrete world of signals, circuits, and CPUs to create something incredibly useful.&lt;/p&gt;
&lt;p&gt;In this post I&amp;rsquo;ll share what I&amp;rsquo;ve learned so far about algebraic codes and go into some detail about Reed-Solomon and BCH codes. As a bonus I&amp;rsquo;ll show how to create QR codes.&lt;/p&gt;
&lt;p&gt;&lt;em&gt;Note on code examples&lt;/em&gt;: The full code for this post is at &lt;a href=&#34;https://github.com/meiji163/ecc-clj&#34;&gt;meiji163/ecc-clj&lt;/a&gt;. See the &lt;a href=&#34;#addendum-on-clojure&#34;&gt;addendum on Clojure&lt;/a&gt; for how to play with it yourself.&lt;/p&gt;
&lt;h2 id=&#34;algebra-background&#34;&gt;Algebra Background&lt;/h2&gt;
&lt;p&gt;This section introduces some algebra needeed to understand algebraic codes.
I&amp;rsquo;ve tried to make it understandable to those without an extensive math education.
Feel free to &lt;a href=&#34;#error-correcting-codes&#34;&gt;skip ahead&lt;/a&gt; and come back later.&lt;/p&gt;
&lt;h3 id=&#34;finite-fields&#34;&gt;Finite Fields&lt;/h3&gt;
&lt;p&gt;A &lt;em&gt;field&lt;/em&gt; is (roughly) a structure where you can add, subtract, multiply, and divide in the ways you&amp;rsquo;re used to. You&amp;rsquo;re already familiar with the field of real numbers, called \( \mathbb{R}\).
You may also be familiar with the field of integers modulo p, called \(GF(p)\)&lt;sup id=&#34;fnref:1&#34;&gt;&lt;a href=&#34;#fn:1&#34; class=&#34;footnote-ref&#34; role=&#34;doc-noteref&#34;&gt;1&lt;/a&gt;&lt;/sup&gt; (also known as \( \mathbb{Z}/p\mathbb{Z}\)).
You add and multiply the same as regular integers, but take the remainder of the result when divided by \(p\).&lt;/p&gt;
&lt;p&gt;For number-theoretic reasons&lt;sup id=&#34;fnref:2&#34;&gt;&lt;a href=&#34;#fn:2&#34; class=&#34;footnote-ref&#34; role=&#34;doc-noteref&#34;&gt;2&lt;/a&gt;&lt;/sup&gt;, \(p\) has to be a prime for division to work.
This ensures that for all \(a = 1,2,\dots,p-1\) there is an integer \(0 &amp;lt; b &amp;lt; p\) such that&lt;/p&gt;
&lt;p&gt;$$a \cdot b = 1 \pmod{p}.$$&lt;/p&gt;
&lt;p&gt;So \(b\) is the inverse of \(a\). Division by \(a\) is then defined as multiplication by \(b.\)&lt;/p&gt;
&lt;p&gt;As an example field, take the teeny little \(GF(2)\). It has two elements 0 and 1.&lt;/p&gt;
&lt;p&gt;$$
\begin{aligned}
1 + 1 &amp;amp;= 0 \cr
1 + 0 &amp;amp;= 1 \cr
1 \cdot 1 &amp;amp;= 1 \cr
1 \cdot 0 &amp;amp;= 0
\end{aligned}
$$&lt;/p&gt;
&lt;p&gt;We could represent this in code as a collection of the field operations&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-clojure&#34; data-lang=&#34;clojure&#34;&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;def &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;GF2&lt;/span&gt;
  &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;ss&#34;&gt;:+&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;bit-xor&lt;/span&gt;
   &lt;span class=&#34;ss&#34;&gt;:-&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;bit-xor&lt;/span&gt;
   &lt;span class=&#34;ss&#34;&gt;:*&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;bit-and&lt;/span&gt;
   &lt;span class=&#34;ss&#34;&gt;:/&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;bit-and&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;})&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;You may think, &lt;em&gt;&amp;ldquo;You have shown me one example of a finite field, now I demand a complete classification of all finite fields!&amp;quot;&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;Luckily, it can be shown&lt;sup id=&#34;fnref:3&#34;&gt;&lt;a href=&#34;#fn:3&#34; class=&#34;footnote-ref&#34; role=&#34;doc-noteref&#34;&gt;3&lt;/a&gt;&lt;/sup&gt; that the number of elements a finite field can have must be \(p^n\) for some prime \(p\) and some integer \(n \gt 0\). We have seen the ones with \(p\) elements, in the next section we&amp;rsquo;ll see the other ones.&lt;/p&gt;
&lt;h3 id=&#34;polynomial-fields&#34;&gt;Polynomial Fields&lt;/h3&gt;
&lt;p&gt;Whenever you have a field \(F\), you can create polynomials whose coefficients are elements of \(F\).
It&amp;rsquo;s usually called \(F[x]\)&lt;sup id=&#34;fnref:4&#34;&gt;&lt;a href=&#34;#fn:4&#34; class=&#34;footnote-ref&#34; role=&#34;doc-noteref&#34;&gt;4&lt;/a&gt;&lt;/sup&gt;.
For example, a polynomial with binary coefficients like \(x^3 + x + 1\) is a member of \(GF(2)[x]\) .&lt;/p&gt;
&lt;p&gt;Polynomials are a bit like vectors. Think of the coefficient of \(x^n\) as the value in the nth slot of a vector, e.g.&lt;/p&gt;
&lt;p&gt;$$ 1x^0 + 1x^1 + 0x^2 + 1x^3 \leftrightarrow (1,1,0,1).$$&lt;/p&gt;
&lt;p&gt;Now to add polynomials, we just add each corresponding coordinate of the vectors.&lt;/p&gt;
&lt;p&gt;&lt;em&gt;So then polynomial multiplication also defines multiplication of vectors?&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;Not quite. The trouble is when you multiply two polynomials, the degree of the product polynomial is can grow without bound! That&amp;rsquo;s not good if we want to the vector size to be fixed.&lt;/p&gt;
&lt;p&gt;This is where we take inspiration from the integers mod \(p\).
In that case, whenever we get a result bigger than \(p\), we divide it by \(p\) and use the remainder instead.
Similarly, for polynomials we choose a &amp;ldquo;modulus&amp;rdquo; polynomial \(p(x)\) with degree \(n\).
Whenever a polynomial has a degree greater than \(n\), we divide it by \(p(x)\) and take the remainder polynomial. The reason this works is that, like the integers, polynomials have a &lt;a href=&#34;https://en.wikipedia.org/wiki/Euclidean_domain&#34;&gt;Euclidean algorithm&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;&lt;em&gt;Can you use any modulus polynomial you want?&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;You can, but in general you get a &amp;ldquo;quotient ring&amp;rdquo;  and not a field.
Like the integer case, we have to choose \(p(x)\) to be &amp;ldquo;prime&amp;rdquo; in order to make division work.
As you might guess, a prime polynomial is one that can&amp;rsquo;t be factored into other polynomials &amp;ndash; remarkable how similar polynomials and integers are!&lt;/p&gt;
&lt;h3 id=&#34;constructing-gf2n&#34;&gt;Constructing \(GF(2^n)\)&lt;/h3&gt;
&lt;p&gt;To see this in action let&amp;rsquo;s construct \(GF(2^3)\) from \(GF(2)\) polynomials.&lt;/p&gt;
&lt;p&gt;Let \(p(x) = x^3 + x + 1\), which is a prime polynomial over \(GF(2)\). Now the distinct nonzero elements of the field are the eight \(GF(2)\) polynomials with degree &amp;lt; 3. We can multiply them like so&lt;/p&gt;
&lt;p&gt;$$
\begin{aligned}
x \cdot (x^2 + x) = x^3 + x^2  = x^2 + x + 1
\end{aligned}
$$&lt;/p&gt;
&lt;p&gt;where we replaced \(x^3\) by \( x + 1\), or equivalently, divided out \(p(x)\).&lt;/p&gt;
&lt;p&gt;When the polynomials as viewed binary vectors, we can interpret each vector as spelling out an integer in binary. For example \(x^2 + x + 1 \leftrightarrow 111_2 = 7\).
Each field element gets assigned a number 0-7 according to this notational pun. &lt;em&gt;But beware, you can&amp;rsquo;t add and multiply them like regular integers&lt;sup id=&#34;fnref:5&#34;&gt;&lt;a href=&#34;#fn:5&#34; class=&#34;footnote-ref&#34; role=&#34;doc-noteref&#34;&gt;5&lt;/a&gt;&lt;/sup&gt;!&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;Another way of representing finite fields comes from the &lt;a href=&#34;https://en.wikipedia.org/wiki/Primitive_element_theorem&#34;&gt;primitive element theorem&lt;/a&gt;, which says that every finite field has a special element \(\omega\), called the primitive element, such that the successive powers \(\omega^1, \omega^2, \dots \) generate the whole field.&lt;/p&gt;
&lt;p&gt;In our contruction of \(GF(2^3)\), a primitive element is the polynomial \(x\), aka &amp;ldquo;\(2\)&amp;rdquo; in our binary labeling scheme. Compare the different representations in the table below.&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;decimal&lt;/th&gt;
&lt;th&gt;binary&lt;/th&gt;
&lt;th&gt;polynomial&lt;/th&gt;
&lt;th&gt;exponential&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;2&lt;/td&gt;
&lt;td&gt;010&lt;/td&gt;
&lt;td&gt;\(x\)&lt;/td&gt;
&lt;td&gt;\( \omega^1\)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;4&lt;/td&gt;
&lt;td&gt;100&lt;/td&gt;
&lt;td&gt;\(x^2\)&lt;/td&gt;
&lt;td&gt;\( \omega^2\)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;3&lt;/td&gt;
&lt;td&gt;011&lt;/td&gt;
&lt;td&gt;\(x+1\)&lt;/td&gt;
&lt;td&gt;\( \omega^3\)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;6&lt;/td&gt;
&lt;td&gt;110&lt;/td&gt;
&lt;td&gt;\(x^2+x\)&lt;/td&gt;
&lt;td&gt;\( \omega^4\)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;7&lt;/td&gt;
&lt;td&gt;111&lt;/td&gt;
&lt;td&gt;\(x^2+x+1\)&lt;/td&gt;
&lt;td&gt;\( \omega^5\)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;5&lt;/td&gt;
&lt;td&gt;101&lt;/td&gt;
&lt;td&gt;\(x^2+1\)&lt;/td&gt;
&lt;td&gt;\( \omega^6\)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;1&lt;/td&gt;
&lt;td&gt;001&lt;/td&gt;
&lt;td&gt;\(1\)&lt;/td&gt;
&lt;td&gt;\( \omega^0 ( = \omega^7 )\)&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;We can implement this construction in code with something like this&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-clojure&#34; data-lang=&#34;clojure&#34;&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;defn &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;char2-field&lt;/span&gt;
  &lt;span class=&#34;s&#34;&gt;&amp;#34;construct field GF2[x]/&amp;lt;p(x)&amp;gt;
&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;  given a primitive element and generating polynomial&amp;#34;&lt;/span&gt;
  &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;prim&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;poly&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
  &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;let &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;invs&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;char2-invs&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;prim&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;poly&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
        &lt;span class=&#34;nv&#34;&gt;n-elts&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;bit-shift-left &lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;bindeg&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;poly&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
        &lt;span class=&#34;nv&#34;&gt;exp&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;vec&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;take &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;n-elts&lt;/span&gt;
                   &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;iterate &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;#&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;binmod&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;bin*&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;%&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;prim&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;poly&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)))]&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;ss&#34;&gt;:unit&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;
     &lt;span class=&#34;ss&#34;&gt;:zero&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;
     &lt;span class=&#34;ss&#34;&gt;:primitive&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;prim&lt;/span&gt;
     &lt;span class=&#34;ss&#34;&gt;:inv&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;invs&lt;/span&gt;
     &lt;span class=&#34;ss&#34;&gt;:exp&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;exp&lt;/span&gt;
     &lt;span class=&#34;ss&#34;&gt;:+&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;bit-xor&lt;/span&gt;
     &lt;span class=&#34;ss&#34;&gt;:-&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;bit-xor&lt;/span&gt;
     &lt;span class=&#34;ss&#34;&gt;:*&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;fn &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;p1&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;p2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;binmod&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;bin*&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;p1&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;p2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;poly&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
     &lt;span class=&#34;ss&#34;&gt;:/&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;fn &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;p1&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;p2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;binmod&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;bin*&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;p1&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;invs&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;p2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))))}&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;The important points are that &lt;code&gt;exp&lt;/code&gt; is a vector containing \(\omega^0, \omega^1, \dots, \omega^{2^n - 1}\),
and we define the field multiplication &lt;code&gt;:*&lt;/code&gt; and field &lt;code&gt;:/&lt;/code&gt; with the functions &lt;code&gt;binmod&lt;/code&gt; and &lt;code&gt;bin*&lt;/code&gt; that implement GF2-polynomial modulo reduction and multiplication, respectively.&lt;/p&gt;
&lt;p&gt;Now we can create GF8!&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-clojure&#34; data-lang=&#34;clojure&#34;&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;def &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;GF8&lt;/span&gt;
  &lt;span class=&#34;s&#34;&gt;&amp;#34;GF(8) constructed as GF2[x]/&amp;lt;x^3+x+1&amp;gt;&amp;#34;&lt;/span&gt;
  &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;let &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;GF2-poly&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;parse-bin&lt;/span&gt; &lt;span class=&#34;s&#34;&gt;&amp;#34;1011&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)]&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;char2-field&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;GF2-poly&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)))&lt;/span&gt;
    
&lt;span class=&#34;c1&#34;&gt;;; examples    &lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;let &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;mul&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;ss&#34;&gt;:*&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;GF8&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
      &lt;span class=&#34;nv&#34;&gt;add&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;ss&#34;&gt;:+&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;GF8&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
      &lt;span class=&#34;nv&#34;&gt;div&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;ss&#34;&gt;:/&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;GF8&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)]&lt;/span&gt;
  &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;mul&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;;; =&amp;gt; 5&lt;/span&gt;
  &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;add&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;7&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;6&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;;; =&amp;gt; 1&lt;/span&gt;
  &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;div&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;5&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;4&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;;; =&amp;gt; 6&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;error-correcting-codes&#34;&gt;Error Correcting Codes&lt;/h2&gt;
&lt;blockquote&gt;
&lt;p&gt;&amp;ldquo;Thus finding an error-correcting code is the same as finding a set of code points in the \(n\)-dimensional space which has the required minimum distance between legal messages&amp;rdquo;&lt;/p&gt;
&lt;p&gt;&amp;ndash; Richard Hamming, &lt;em&gt;The Art of Doing Science and Engineering&lt;/em&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;The main problem motivating error correcting codes is reliable data transmission.
When sending symbols (such as bits) over a medium that can introduce errors or erasures, how do you ensure that your intended message gets through?&lt;/p&gt;
&lt;p&gt;Hamming&amp;rsquo;s insight was to formulate this as a max-min distance problem.
Let&amp;rsquo;s consider the symbols as elements of a finite field \(F\). Then a block of \(n\) symbols, or &amp;ldquo;word&amp;rdquo;, corresponds to a vector in \(F^n\).
What we want is a set of &amp;ldquo;codeword&amp;rdquo; vectors such that whenever errors occur, the erroneous vector can be mapped uniquely to the &amp;ldquo;closest&amp;rdquo; correct codeword vector.&lt;/p&gt;
&lt;p&gt;Thus we need the codewords to be as &amp;ldquo;far apart&amp;rdquo; as possible, to minimize the chances of a word being &amp;ldquo;close&amp;rdquo; to two codewords simulatenously.
The &lt;a href=&#34;https://en.wikipedia.org/wiki/Hamming_distance&#34;&gt;Hamming Distance&lt;/a&gt;, defined as the number of places where two words differ, is exactly the right notion of distance to measure this. Now the problem can be phrased as:&lt;/p&gt;
&lt;p&gt;&lt;em&gt;Find a set of codewords that maximizes the minimum distance betweeen any two codewords.&lt;/em&gt;&lt;/p&gt;
&lt;h3 id=&#34;algebraic-codes&#34;&gt;Algebraic Codes&lt;/h3&gt;
&lt;p&gt;Codeword vectors can be chosen arbitrarily, but to make the problem tractable we impose an algebraic structure on the codewords, like a musician might impose meter and harmony on their music.&lt;/p&gt;
&lt;p&gt;First require that the codewords form a &lt;em&gt;linear subspace&lt;/em&gt; of \(F^n\).
That means whenever we add two codeword vectors or scale a codeword vector, we get another codeword vector.
These are called &lt;em&gt;linear codes&lt;/em&gt;. It&amp;rsquo;s not too hard to bound the best possible minimum distance for linear codes.&lt;/p&gt;
&lt;p&gt;But first, a little more terminology: A code that encodes length \(k\) words into length \(n\) codewords and uses \(n-k\) check symbols is called an \( (n, k)\) code. Now we can state the&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Hamming Bound:&lt;/strong&gt;
The minimum distance \( d_{min} \) between any two codewords of a \( (n,k) \) linear code satisfies \(d_{min} \le n-k+1\).&lt;sup id=&#34;fnref:6&#34;&gt;&lt;a href=&#34;#fn:6&#34; class=&#34;footnote-ref&#34; role=&#34;doc-noteref&#34;&gt;6&lt;/a&gt;&lt;/sup&gt;&lt;/p&gt;
&lt;p&gt;This tells us the max number of errors a linear code can correct is \( \lfloor (n-k+1)/2 \rfloor \). However it does not tell us if such a code exists for a given \(n\) and \(k\) (booo!).&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Example:&lt;/strong&gt; The \( (7,4) \) binary Hamming code can correct 1 error. Its codewords form a four-dimensional subspace of \(GF(2)^7\), spanned by these vectors:&lt;/p&gt;
&lt;p&gt;$$
\begin{aligned}
1000110 &amp;amp; \cr
0100101 &amp;amp; \cr
0010011 &amp;amp; \cr
0001111
\end{aligned}
$$&lt;/p&gt;
&lt;p&gt;&lt;em&gt;What&amp;rsquo;s with the vectors and linear subspaces? I was promised polynomials!&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;But remember polynomials are like vectors too &amp;ndash; we view the coefficients as vector coordinates. Then we can use a &amp;ldquo;&lt;em&gt;generator polynomial&lt;/em&gt;&amp;rdquo; \(g(x)\) with degree \(n-k\) to generate a linear code as follows.&lt;/p&gt;
&lt;p&gt;For every &amp;ldquo;word polynomial&amp;rdquo; \(w(x)\) of degree \(k\), the product \(g(x)w(x)\) defines a codeword polynomial of degree \(n\). Considered as vectors, these polynomials span a linear subspace of \(F^n.\) For example, \(g(x) = x^3+x+1\) generates the Hamming code above.&lt;/p&gt;
&lt;h3 id=&#34;cyclic-codes&#34;&gt;Cyclic Codes&lt;/h3&gt;
&lt;p&gt;Linear codes are great, but can we impose even &lt;em&gt;more&lt;/em&gt; structure to find better codes? One idea is to consider linear subspaces that are highly symmetrical. That is where &lt;em&gt;cyclic codes&lt;/em&gt; come in.&lt;/p&gt;
&lt;p&gt;A &lt;em&gt;cyclic code&lt;/em&gt; is a linear code that is invariant under a cyclic shift, e.g. if &lt;code&gt;1100&lt;/code&gt; is a codeword then so is &lt;code&gt;0110&lt;/code&gt; and &lt;code&gt;0011&lt;/code&gt;. If we translate this back to polynomial language, it requires that \(x^n\) &amp;ldquo;wraps around&amp;rdquo; and becomes \(x^0\). Algebraically, this means we take the ring of polynomials \(F[x]\) &lt;em&gt;modulo&lt;/em&gt; \(x^n-1\)&lt;sup id=&#34;fnref:7&#34;&gt;&lt;a href=&#34;#fn:7&#34; class=&#34;footnote-ref&#34; role=&#34;doc-noteref&#34;&gt;7&lt;/a&gt;&lt;/sup&gt;. However we say it, what it means in practice is that we carefully choose the generating polynomial \(g(x)\) to be a factor of \(x^n-1\).&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Example:&lt;/strong&gt; Here are some factorizations of \(x^n-1\) over \(GF(2)\) into prime polynomials.&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;\(n\)&lt;/th&gt;
&lt;th&gt;Factorization of \(x^n - 1\)&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;3&lt;/td&gt;
&lt;td&gt;\( (1+x)(1+x+x^2) \)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;5&lt;/td&gt;
&lt;td&gt;\( (1+x)(1+x+x^2+x^3+x^4)\)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;7&lt;/td&gt;
&lt;td&gt;\( (1+x)(1+x^2+x^3)(1+x+x^3)\)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;9&lt;/td&gt;
&lt;td&gt;\( (1+x)(1+x+x^2)(1+x^3+x^6)\)&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;For each \(n\), a choice of factors gives you a cyclic code. For example choosing \(g(x) = 1+x\)
gives you a simple code that adds one parity-check bit.&lt;/p&gt;
&lt;p&gt;It&amp;rsquo;s fun to discover what codes these polynomials will produce, but it&amp;rsquo;s usually not easy to see what the minimum distance is. For that we need to use more strategic constructions.&lt;/p&gt;
&lt;p&gt;(An aside for true math nerds: let me mention a &amp;ldquo;platypus&amp;rdquo; of the cyclic code zoo.
The \((23,12)\) binary Golay code has a minimum distance of 7 and &lt;em&gt;perfectly&lt;/em&gt; partitions the space \(GF(2)^{23}\) into spheres of radius 3. Its automorphism group is a &lt;a href=&#34;https://en.wikipedia.org/wiki/Mathieu_group&#34;&gt;sporadic group&lt;/a&gt;. The derivative \((24,12)\) Golay code is even more amazing and bizzare&lt;sup id=&#34;fnref:8&#34;&gt;&lt;a href=&#34;#fn:8&#34; class=&#34;footnote-ref&#34; role=&#34;doc-noteref&#34;&gt;8&lt;/a&gt;&lt;/sup&gt;.)&lt;/p&gt;
&lt;h3 id=&#34;reed-solomon-codes&#34;&gt;Reed-Solomon Codes&lt;/h3&gt;
&lt;p&gt;Reed-Solomon codes are some of the best and most widely used cyclic codes.
To make your own \( (n,k) \) RS code, let \(\omega\) be a primitive element of your field \(F\).
For the generating polynomial, cook up a polynomial in \(F[x]\) with roots at \(\omega^j, \omega^{j+1}, \dots, \omega^{j+m}\) for some integers \(j \ge 0\) and \(0&amp;lt;m&amp;lt;n\). For example,&lt;/p&gt;
&lt;p&gt;$$ g(x) = (x-\omega)(x-\omega^2)\dots(x-\omega^m).$$&lt;/p&gt;
&lt;p&gt;To guarantee this generates a cyclic code, we require that the size of the field \(F\) equals \(n\). Then \(g(x)\) is a factor of \(x^n - 1\) because \(\omega^n = 1\).&lt;/p&gt;
&lt;p&gt;&lt;em&gt;OK I cooked up my RS code, but why is it good?&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;It can be shown&lt;sup id=&#34;fnref:9&#34;&gt;&lt;a href=&#34;#fn:9&#34; class=&#34;footnote-ref&#34; role=&#34;doc-noteref&#34;&gt;9&lt;/a&gt;&lt;/sup&gt; that whenever a \( (n,k) \) RS code exists, it achieves equality in the Hamming bound, i.e. \(d_{min} = n-k+1\). So these codes are optimally error correcting linear codes.&lt;/p&gt;
&lt;p&gt;What accounts for this? It&amp;rsquo;s closely related to the Fourier transform over the field \(F\).
If you&amp;rsquo;re familiar with the &lt;a href=&#34;https://en.wikipedia.org/wiki/Discrete_Fourier_transform&#34;&gt;Discrete Fourier transform&lt;/a&gt; of a vector, it&amp;rsquo;s exactly the same except \(\omega\) plays the role of \(e^{-2\pi i/n}.\) Requiring \(\omega^j\) to be a root of \(g(x)\) is equivalent to requiring the \(j^{th}\) component of the Fourier transform to be 0.&lt;/p&gt;
&lt;p&gt;The RS generating polynomial would be analogous to a low-pass frequency filter, requiring all frequencies to be greater than some value. This forces the minimum weight (i.e. number of nonzero components) of a codeword to be bounded away from 0.&lt;/p&gt;
&lt;p&gt;(This is a manifestation of &lt;a href=&#34;https://terrytao.wordpress.com/2010/06/25/the-uncertainty-principle/&#34;&gt;the uncertainty principle&lt;/a&gt;, which roughly says that you cannot be simultaneously localized in both frequency and position. &lt;a href=&#34;#references&#34;&gt;[8]&lt;/a&gt;)&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Examples:&lt;/strong&gt; Let&amp;rsquo;s construct a \( (7,3) \) RS code over \( GF(8) \), using the representation of \(GF(8)\) from before. Let&amp;rsquo;s choose the generating polynomial as&lt;/p&gt;
&lt;p&gt;$$ g(x) = (x-\omega^4)(x-\omega^5)(x-\omega^6)(x-\omega^7).$$&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-clojure&#34; data-lang=&#34;clojure&#34;&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;def &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;RS-7-3&lt;/span&gt; 
  &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;reduce&lt;/span&gt;
   &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;fn &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;p1&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;p2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;p/*&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;p1&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;p2&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;GF8&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
   &lt;span class=&#34;p&#34;&gt;[[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;7&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;6&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]]))&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Now I can encode my favorite integer, 163.
With check symbols it is &lt;code&gt;3326163&lt;/code&gt;. Now I can change any two of the symbols and it decodes to &lt;code&gt;163&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-clojure&#34; data-lang=&#34;clojure&#34;&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;encode&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;6&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;RS-7-3&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;GF8&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;;; =&amp;gt; [3 3 2 6 1 6 3]&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;RS-7-3-decode&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;6&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;6&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;])&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;;; =&amp;gt; [1 6 3]&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;RS-7-3-decode&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;6&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;7&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;])&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;;; =&amp;gt; [1 6 3]&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;RS-7-3-decode&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;6&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;6&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;6&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;6&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;])&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;;; =&amp;gt; [1 6 3]&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;It feels &lt;em&gt;magical&lt;/em&gt; when you see it up close!&lt;/p&gt;
&lt;p&gt;For a bigger example, let&amp;rsquo;s construct a \( (255, 233) \) RS code over \(GF(256)\). It uses 32 check symbols to correct 16 errors. This code is one recommended by the &amp;ldquo;Consultative Committee for Space Data Systems&amp;rdquo; &lt;a href=&#34;#references&#34;&gt;[4]&lt;/a&gt;. Famously, it was used for &lt;a href=&#34;https://en.wikipedia.org/wiki/Voyager_program&#34;&gt;Voyager mission&lt;/a&gt; communications (in combination with other error-correcting codes).&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-clojure&#34; data-lang=&#34;clojure&#34;&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;def &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;RS-255-223&lt;/span&gt;
  &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;let &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;exp&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;ss&#34;&gt;:exp&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;GF256&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
        &lt;span class=&#34;nv&#34;&gt;roots&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;for &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;e&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;range &lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;33&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)]&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;exp&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;e&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))]&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;reduce&lt;/span&gt;
     &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;fn &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;p1&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;p2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;p/*&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;p1&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;p2&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;GF256&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
     &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;for &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;r&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;roots&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;r&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]))))&lt;/span&gt;

&lt;span class=&#34;c1&#34;&gt;;; example encoding&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;let &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;message&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;str&lt;/span&gt;
       &lt;span class=&#34;s&#34;&gt;&amp;#34;Hello world! This is meiji163 transmitting from Neptune. &amp;#34;&lt;/span&gt;
       &lt;span class=&#34;s&#34;&gt;&amp;#34;It&amp;#39;s cold here, Please send hot chocolate. Thanks. &amp;#34;&lt;/span&gt;
       &lt;span class=&#34;s&#34;&gt;&amp;#34;Now that I think of it, ramen would be good too if you have some.&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
      &lt;span class=&#34;nv&#34;&gt;data&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;map int &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;message&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
      &lt;span class=&#34;nv&#34;&gt;padded&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;p/shift-right&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;data&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;- &lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;223&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;count &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;data&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)))]&lt;/span&gt;
      &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;encode&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;padded&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;RS-255-223&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;GF256&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;bch-codes&#34;&gt;BCH codes&lt;/h3&gt;
&lt;p&gt;Bose–Chaudhuri–Hocquenghem (BCH) codes follow a similar idea to Reed-Solomon codes.
A limitation of RS codes is that the field has to be the same size as \(n\), the codeword length.&lt;/p&gt;
&lt;p&gt;However it is still possible to specify the roots of \(g(x)\) in an &lt;em&gt;extension field&lt;/em&gt; of \(F\).
To see what I mean, let \(\omega = 2\) be a primitive element of \(GF(16)\) and let
$$
\begin{aligned}
g(x) &amp;amp;= (x-\omega)(x-\omega^2)(x-\omega^3)(x-\omega^4) \cr
&amp;amp;= (x^4+x+1)(x^4+x^3+x^2+1).
\end{aligned}
$$&lt;/p&gt;
&lt;p&gt;This polynomial has coefficients in \(GF(2)\), but its roots lie in the bigger field \(GF(16).\) This is analogous to a polynomial with real-valued coefficients having complex roots.&lt;/p&gt;
&lt;p&gt;The same argument from the RS codes shows that BCH codes are also optimal. The polynomial generates the \((15,7)\) binary BCH code, which corrects 2 errors.&lt;/p&gt;
&lt;h3 id=&#34;codecs&#34;&gt;Codecs&lt;/h3&gt;
&lt;p&gt;As I said above, given a generating polynomial \(g(x)\) and data polynomial \(w(x)\) one way to encode is to use \(g(x)w(x)\) as the codeword. The codeword polynomials are the ones divisible by \(g(x).\)&lt;/p&gt;
&lt;p&gt;It&amp;rsquo;s more convenient to use an encoding where the symbols of \(w(x)\) are visible in the codeword polynomial. To do this, set the top \(k\) coefficients as the coefficients of \(w(x)\), then add a degree \(n-k\) polynomial such that the codeword \(c(x)\)is divisible by \(g(x).\)
Algebraically, \( c(x) = x^k w(x) + r(x) \) where \(r(x) = -x^k w(k) \pmod{g(x)}\).&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-clojure&#34; data-lang=&#34;clojure&#34;&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;defn &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;encode&lt;/span&gt;
  &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;data-poly&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;gen-poly&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;field&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]]&lt;/span&gt;
  &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;let &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;field&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;or &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;field&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;p/default-field&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
        &lt;span class=&#34;nv&#34;&gt;shifted&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;p/shift-right&lt;/span&gt;
                 &lt;span class=&#34;nv&#34;&gt;data-poly&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;dec &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;count &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;gen-poly&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)))&lt;/span&gt;
        &lt;span class=&#34;nb&#34;&gt;rem &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;p/mod&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;shifted&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;gen-poly&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;field&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)]&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;p/+&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;shifted&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;rem &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;field&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)))&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;em&gt;Decoding&lt;/em&gt; is considerably harder because we have to exploit the algebraic structure of the code to locate the errors and their magnitudes. For small codes, you can make a table of error patterns and their remainders modulo \(g(x)\). For example,&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-clojure&#34; data-lang=&#34;clojure&#34;&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;def &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;RS-7-5-table&lt;/span&gt;
  &lt;span class=&#34;s&#34;&gt;&amp;#34;Decoding table for (7,5) Reed-Solomon code.&amp;#34;&lt;/span&gt;
  &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;let &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;errors&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;single-errors&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;7&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;8&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
        &lt;span class=&#34;nv&#34;&gt;rems&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;map &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;fn &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;e&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;p/mod&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;e&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;RS-7-5&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;GF8&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;errors&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)]&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;zipmap &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;rems&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;errors&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)))&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Given a message \(m(x)\) simply look up the error from \(m(x) \pmod{g(x)}\).&lt;/p&gt;
&lt;p&gt;To decode larger RS codes the main tool is &lt;em&gt;syndromes&lt;/em&gt;. Syndromes are defined as \(S_j = m(\omega^j)\) for all \(\omega^j\) that are specified as the roots of \(g(x)\). If no errors occured, all the syndromes will be zero.&lt;/p&gt;
&lt;p&gt;On the other hand, if a correctable number of errors occurred, the idea is to form a linear system of equations using the syndromes to find the positions of the errors and the locations. I implemented the linear solver decoder &lt;a href=&#34;https://github.com/meiji163/ecc-clj/blob/fb6bacba8280a33724c968718cb9d2194c74e58e/src/ecc_clj/core.clj#L181-L210&#34;&gt;here&lt;/a&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-clojure&#34; data-lang=&#34;clojure&#34;&gt;&lt;span class=&#34;c1&#34;&gt;;; decoding (255,223) RS code&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;let &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;err&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;42&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;163&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;66&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;101&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;100&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
      &lt;span class=&#34;nv&#34;&gt;max-errs&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;8&lt;/span&gt;
      &lt;span class=&#34;nv&#34;&gt;decode-me&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;p/+&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;msg-poly&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;err&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;GF256&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)]&lt;/span&gt;
  &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;decode&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;decode-me&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;max-errs&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;GF256&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)))&lt;/span&gt;
  &lt;span class=&#34;c1&#34;&gt;;; =&amp;gt; {:locations [1 2 5 8 14 15], &lt;/span&gt;
  &lt;span class=&#34;c1&#34;&gt;;;     :sizes [42 1 163 66 101 100]}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;A more efficient decoder is based on the &lt;a href=&#34;https://en.wikipedia.org/wiki/Berlekamp%E2%80%93Massey_algorithm&#34;&gt;Berlekamp-Massey algorithm&lt;/a&gt;, which I haven&amp;rsquo;t implemented. (Maybe you can, my brave reader)&lt;/p&gt;
&lt;h2 id=&#34;generating-qr-codes&#34;&gt;Generating QR Codes&lt;/h2&gt;
&lt;p&gt;Typically error-correcting codecs are implemented in hardware circuits, which run many orders of magnitude faster than my implementation.
However just to prove that my terribly slow implementation isn&amp;rsquo;t completely useless, I made a QR code generator.&lt;/p&gt;
&lt;p&gt;There are many versions of QR codes, so I went with the 21x21 version as specified by the ISO/IEC standard &lt;a href=&#34;#references&#34;&gt;[5]&lt;/a&gt;. I implemented just enough of the standard to make some example QR codes.&lt;/p&gt;
&lt;h3 id=&#34;qr-specification&#34;&gt;QR specification&lt;/h3&gt;
&lt;p&gt;There are two error-correcting codes involved in the QR code. One is for the &amp;ldquo;format bits&amp;rdquo; and the other is for the &amp;ldquo;data bits&amp;rdquo;.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Format bits:&lt;/strong&gt;
There are 5 format bits. The first 2 specify the error-correction level and the last 3 specify the bitmask.
The 5 bits are protected by a \( (15,5) \) BCH code with 10 check bits. This can correct up to 5 errors (Wikipedia falsely claims it can only correct 3).
Two copies of the encoded bits are included, for a total of 30 bits.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Data bits&lt;/strong&gt;:
The message can be up to 17 bytes.
The message bits are prepended with a 4-bit datatype code followed by an 8-bit integer specifying the message length. The 4-bit end sequence &lt;code&gt;0000&lt;/code&gt; is appended to the message.&lt;/p&gt;
&lt;p&gt;Finally, these 19 bytes are encoded with a \( (255, 248) \) Reed-Solomon code, which can correct 2 byte errors. You may see this code called a \( (26, 19) \) code because only 19 of the 248 bytes are used. This is the lowest error correcting level; other possible generating polynomials are listed in the standard.&lt;/p&gt;
&lt;p&gt;Finally, the data bits are masked with a pattern specified in the format bits. The purpose of the bitmask is to preventing large areas of a single color.&lt;/p&gt;

&lt;link rel=&#34;stylesheet&#34; href=&#34;https://meiji163.github.io/css/hugo-easy-gallery.css&#34; /&gt;
&lt;div class=&#34;box&#34;&gt;
&lt;figure  itemprop=&#34;associatedMedia&#34;
  itemscope itemtype=&#34;http://schema.org/ImageObject&#34; &gt;
    &lt;div class=&#34;img&#34;&gt;
      &lt;img itemprop=&#34;thumbnail&#34; src=&#34;https://meiji163.github.io/images/qrcode.png&#34; alt=&#34;The bit layout for QR code v1. Image from Wikipedia&#34;/&gt;
    &lt;/div&gt;
    &lt;a href=&#34;https://meiji163.github.io/images/qrcode.png&#34; itemprop=&#34;contentUrl&#34;&gt;&lt;/a&gt;
      &lt;figcaption&gt;
          &lt;p&gt;The bit layout for QR code v1. Image from Wikipedia&lt;/p&gt;
      &lt;/figcaption&gt;
  &lt;/figure&gt;
&lt;/div&gt;

&lt;p&gt;The implementation of the RS and BCH codes is straightforward. We just have to be careful to use the same GF256 construction and generating polynomial as the one specified in the standard (Annex A in the manual).&lt;/p&gt;
&lt;p&gt;The generating polynomial for the Reed-Solomon code is&lt;/p&gt;
&lt;p&gt;$$ g(x) = 117 + 68x + 11x^2 + 164x^3 + 154x^4 + 122x^5 + 127x^6 +  x^7 $$
which is computed from \((x-\omega^0)(x-\omega^1)\dots(x-\omega^6)\).&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-clojure&#34; data-lang=&#34;clojure&#34;&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;def &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;GF256&lt;/span&gt;
  &lt;span class=&#34;s&#34;&gt;&amp;#34;GF(255) constructed as GF2[x]/&amp;lt;x^8+x^4+x^3+x^2+1&amp;gt;&amp;#34;&lt;/span&gt;
  &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;let &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;GF2-poly&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;p/parse-bin&lt;/span&gt; &lt;span class=&#34;s&#34;&gt;&amp;#34;100011101&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)]&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;p/char2-field&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;GF2-poly&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)))&lt;/span&gt;

&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;def &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;RS-255-248&lt;/span&gt;
  &lt;span class=&#34;s&#34;&gt;&amp;#34;(255,248) Reed-Solomon code over GF256&amp;#34;&lt;/span&gt;
  &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;let &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;roots&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;take &lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;7&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;ss&#34;&gt;:exp&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;GF256&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))]&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;reduce&lt;/span&gt;
     &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;fn &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;p1&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;p2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;p/*&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;p1&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;p2&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;GF256&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
     &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;for &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;r&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;roots&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;r&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]))))&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;For the BCH code, the generating polynomial is the minimal polynomial of \(\omega, \omega^2, \dots, \omega^6\) over \(GF(2)\). This turns out as
$$
(1+x+x^4)(1+x+x^2+x^3+x^4)(1+x+x^2).
$$&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-clojure&#34; data-lang=&#34;clojure&#34;&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;def &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;BCH-15-5&lt;/span&gt;
  &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;reduce&lt;/span&gt;
   &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;fn &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;p1&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;p2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;p/*&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;p1&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;p2&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;GF2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
   &lt;span class=&#34;p&#34;&gt;[[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]]))&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Encoding the format bits:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-clojure&#34; data-lang=&#34;clojure&#34;&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;defn &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;fmt-bits&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;mask&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
  &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;let &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;mb&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
        &lt;span class=&#34;nv&#34;&gt;ec-level&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
        &lt;span class=&#34;nv&#34;&gt;bits&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;reverse &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;concat &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;ec-level&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;mb&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
        &lt;span class=&#34;nv&#34;&gt;enc-bt&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;ecc/encode&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;bits&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;ecc/BCH-15-5&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;ecc/GF2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)]&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;p/+&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;reverse &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;enc-bt&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;fmt-bitmask&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;ecc/GF2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)))&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;I&amp;rsquo;ll omit encoding the data bits; it&amp;rsquo;s not as succinct because you have to move around many bits and pieces and pieces of bits.
There are also some details with the bit ordering that bit me a few times (OK I&amp;rsquo;m done punning for a bit). Anyways the full code is &lt;a href=&#34;https://github.com/meiji163/ecc-clj/blob/main/src/ecc_clj/qr.clj&#34;&gt;here&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Now we can reproduce the QR code from the Wikipedia diagram above.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-clojure&#34; data-lang=&#34;clojure&#34;&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;let &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;mask-code&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;
      &lt;span class=&#34;nv&#34;&gt;databits&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;-&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;s&#34;&gt;&amp;#34;www.wikipedia.org&amp;#34;&lt;/span&gt;
                    &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;map &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
                    &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;encode-bytes&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
                    &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;mask-bits&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;mask-code&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
      &lt;span class=&#34;nv&#34;&gt;fmtbits&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;fmt-bits&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;mask-code&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
      &lt;span class=&#34;nv&#34;&gt;myimg&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;qr-image&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;fmtbits&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;databits&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)]&lt;/span&gt;
  &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;ImageIO/write&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;myimg&lt;/span&gt; &lt;span class=&#34;s&#34;&gt;&amp;#34;PNG&amp;#34;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;File.&lt;/span&gt; &lt;span class=&#34;s&#34;&gt;&amp;#34;wikipedia-qr.png&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)))&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&#34;box&#34;&gt;
&lt;figure  itemprop=&#34;associatedMedia&#34;
  itemscope itemtype=&#34;http://schema.org/ImageObject&#34; &gt;
    &lt;div class=&#34;img&#34;&gt;
      &lt;img itemprop=&#34;thumbnail&#34; src=&#34;https://meiji163.github.io/images/wikipedia-qr.png&#34; /&gt;
    &lt;/div&gt;
    &lt;a href=&#34;https://meiji163.github.io/images/wikipedia-qr.png&#34; itemprop=&#34;contentUrl&#34;&gt;&lt;/a&gt;
  &lt;/figure&gt;
&lt;/div&gt;

&lt;h2 id=&#34;conclusion&#34;&gt;Conclusion&lt;/h2&gt;
&lt;p&gt;Error-correcting codes are fundamental algorithms for everything involving data transfer. What&amp;rsquo;s more, they are built from a wonderful blend of linear algebra, geometry, and ring theory. I hope I&amp;rsquo;ve given you a taste for what they are like.&lt;/p&gt;
&lt;p&gt;&lt;em&gt;Zzzz&amp;hellip; I fell asleep right when you mentioned algebra&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;Wake up, there&amp;rsquo;s much more to explore! I&amp;rsquo;ve glossed over and omitted many details. For the interested reader please check out the references &lt;a href=&#34;#references&#34;&gt;[1] [2] [3]&lt;/a&gt;.
There are also many more applications I&amp;rsquo;ve skipped including:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;RAID (specifically &lt;a href=&#34;http://ftp.dei.uc.pt/pub/linux/kernel/people/hpa/raid6.pdf&#34;&gt;RAID6&lt;/a&gt;)&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://en.wikipedia.org/wiki/Cyclic_redundancy_check&#34;&gt;Cyclic redundancy checks&lt;/a&gt; (CRC).&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://en.wikipedia.org/wiki/Cross-interleaved_Reed%E2%80%93Solomon_coding&#34;&gt;CDs&lt;/a&gt; and DVDs&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;I will post a sequel as I learn more, time permitting. I am particularly intrigued by codes based on algebraic curves, which were proposed by Goppa &lt;a href=&#34;#references&#34;&gt;[7]&lt;/a&gt;.&lt;/p&gt;
&lt;h2 id=&#34;addendum-on-clojure&#34;&gt;Addendum on Clojure&lt;/h2&gt;
&lt;p&gt;&lt;em&gt;Why use Clojure for this?&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;I have long been curious about Lisp languages but never had occasion to use one seriously.
I was inspired by Sam Ritchie&amp;rsquo;s work on &lt;a href=&#34;https://github.com/sicmutils/sicmutils&#34;&gt;sicmutils&lt;/a&gt; to use Clojure for exploratory self-education. Also, Rich Hickey is cool.&lt;/p&gt;
&lt;p&gt;&lt;em&gt;Shouldn&amp;rsquo;t you use Haskell instead?&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;Yes I should. In fact I look up at the Haskellers in their ivory tower and seethe with envy.
In all seriousness I did think about it, but Clojure&amp;rsquo;s dynamic type system and the interactive REPL makes it more enjoyable for explorations like this one IMHO. I found it easier to debug too.&lt;/p&gt;
&lt;p&gt;&lt;em&gt;How do I get started with Clojure?&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;If you use Emacs the best way to get started is with &lt;a href=&#34;https://docs.cider.mx/cider/index.html&#34;&gt;cider&lt;/a&gt;. This will allow you to start an interactive REPL and evaluate expressions right in your editor! I also recommend a plugin like &lt;a href=&#34;https://github.com/abo-abo/lispy&#34;&gt;lispy&lt;/a&gt; to help with structural editing.
For vim, I&amp;rsquo;ve seen &lt;a href=&#34;https://github.com/tpope/vim-fireplace&#34;&gt;this&lt;/a&gt; plugin, but I haven&amp;rsquo;t tried it myself. For VSCode I&amp;rsquo;ve heard &lt;a href=&#34;https://calva.io/&#34;&gt;calva&lt;/a&gt; is great.&lt;/p&gt;
&lt;p&gt;&lt;em&gt;How do I run your code examples?&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;Once you have your Clojure editor setup clone &lt;a href=&#34;https://github.com/meiji163/ecc-clj&#34;&gt;the repo&lt;/a&gt;, run the code, modify it, write your own version, etc. Pull requests are always welcome if you make something cool or improve the code!&lt;/p&gt;
&lt;h2 id=&#34;references&#34;&gt;References&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://www.cambridge.org/core/books/algebraic-codes-for-data-transmission/2F606F75ABE1BAA014A1DE0F5D62F498&#34;&gt;[1]&lt;/a&gt; Blahut, Richard &amp;ldquo;&lt;em&gt;Algebraic Codes for Data Transmission&lt;/em&gt;&amp;rdquo; (2003)&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://cdn.preterhuman.net/texts/math/Codes%20and%20Curves.pdf&#34;&gt;[2]&lt;/a&gt; Walker, Judy &amp;ldquo;&lt;em&gt;Codes and Curves&lt;/em&gt;&amp;rdquo;, Lecture Notes&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://cse.buffalo.edu/faculty/atri/courses/coding-theory/book/index.html&#34;&gt;[3]&lt;/a&gt; Guruswami, Rudra &amp;amp; Sudan &amp;ldquo;&lt;em&gt;Essential Coding Theory&lt;/em&gt;&amp;rdquo;, Online Draft&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://public.ccsds.org/Pubs/130x1g3.pdf&#34;&gt;[4]&lt;/a&gt; CCSDS &amp;ldquo;&lt;em&gt;Report Concerning Space Data System Standards&lt;/em&gt;&amp;rdquo; (2020)&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://github.com/yansikeim/QR-Code/blob/master/ISO%20IEC%2018004%202015%20Standard.pdf&#34;&gt;[5]&lt;/a&gt; ISO/IEC 18004, &amp;ldquo;&lt;em&gt;QR Code bar code symbology specification&lt;/em&gt;&amp;rdquo;, 3rd ed.&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;http://drhuang.com/science/mathematics/book/GTM73-Algebra.Thomas%20W.Hungerford.pdf&#34;&gt;[6]&lt;/a&gt; Hungerford, Thomas &amp;ldquo;&lt;em&gt;Algebra&lt;/em&gt;&amp;rdquo; (1974)&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://www.mathnet.ru/php/archive.phtml?wshow=paper&amp;amp;jrnid=im&amp;amp;paperid=1646&amp;amp;option_lang=eng&#34;&gt;[7]&lt;/a&gt; Goppa, Valery &amp;ldquo;&lt;em&gt;Algebraico-Geometric Codes&lt;/em&gt;&amp;rdquo; Math. USSR Izvestiya Vol. 21 (1983)&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://arxiv.org/pdf/1703.01080.pdf&#34;&gt;[8]&lt;/a&gt; Evra, Kowalski, Lubotzky &amp;ldquo;&lt;em&gt;Good Cyclic Codes and the Uncertainty Principle&lt;/em&gt;&amp;rdquo; (2017)&lt;/p&gt;
&lt;section class=&#34;footnotes&#34; role=&#34;doc-endnotes&#34;&gt;
&lt;hr&gt;
&lt;ol&gt;
&lt;li id=&#34;fn:1&#34; role=&#34;doc-endnote&#34;&gt;
&lt;p&gt;GF stands for &amp;ldquo;Galois field&amp;rdquo; in honor of the legendary Evariste Galois.&amp;#160;&lt;a href=&#34;#fnref:1&#34; class=&#34;footnote-backref&#34; role=&#34;doc-backlink&#34;&gt;&amp;#x21a9;&amp;#xfe0e;&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li id=&#34;fn:2&#34; role=&#34;doc-endnote&#34;&gt;
&lt;p&gt;If you want to prove this, it follows from &lt;a href=&#34;https://math.libretexts.org/Bookshelves/Combinatorics_and_Discrete_Mathematics/Elementary_Number_Theory_(Barrus_and_Clark)/01:_Chapters/1.09:_Bezout&#39;s_Lemma&#34;&gt;Bezout&amp;rsquo;s Lemma&lt;/a&gt;&amp;#160;&lt;a href=&#34;#fnref:2&#34; class=&#34;footnote-backref&#34; role=&#34;doc-backlink&#34;&gt;&amp;#x21a9;&amp;#xfe0e;&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li id=&#34;fn:3&#34; role=&#34;doc-endnote&#34;&gt;
&lt;p&gt;You&amp;rsquo;ll find a proof in any good algebra book, Theorem 5.1 in &lt;a href=&#34;#references&#34;&gt;[6]&lt;/a&gt; for example.&amp;#160;&lt;a href=&#34;#fnref:3&#34; class=&#34;footnote-backref&#34; role=&#34;doc-backlink&#34;&gt;&amp;#x21a9;&amp;#xfe0e;&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li id=&#34;fn:4&#34; role=&#34;doc-endnote&#34;&gt;
&lt;p&gt;Its full name is &amp;ldquo;the ring of polynomials over \(F\)&amp;rdquo;&amp;#160;&lt;a href=&#34;#fnref:4&#34; class=&#34;footnote-backref&#34; role=&#34;doc-backlink&#34;&gt;&amp;#x21a9;&amp;#xfe0e;&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li id=&#34;fn:5&#34; role=&#34;doc-endnote&#34;&gt;
&lt;p&gt;You can now make people think you&amp;rsquo;re crazy by telling them 3 times 3 equals 5&amp;#160;&lt;a href=&#34;#fnref:5&#34; class=&#34;footnote-backref&#34; role=&#34;doc-backlink&#34;&gt;&amp;#x21a9;&amp;#xfe0e;&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li id=&#34;fn:6&#34; role=&#34;doc-endnote&#34;&gt;
&lt;p&gt;Proof: the distance between any two codewords \(c_1\) and \(c_2\) is the same as the distance between the all-zero word and \(c_1 - c_2\). Thus \(d_{min}\) is equal to the minimum number of nonzero components across all nonzero codewords. We can take the codeword with one nonzero data symbol and \(n-k\) check symbols. Hence \(d_{min} \le n-k+1 \).&amp;#160;&lt;a href=&#34;#fnref:6&#34; class=&#34;footnote-backref&#34; role=&#34;doc-backlink&#34;&gt;&amp;#x21a9;&amp;#xfe0e;&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li id=&#34;fn:7&#34; role=&#34;doc-endnote&#34;&gt;
&lt;p&gt;In ring theory terminology, this makes the set of polynomial codewords is an &lt;a href=&#34;https://en.wikipedia.org/wiki/Ideal_(ring_theory)&#34;&gt;ideal&lt;/a&gt; of the quotient ring \(F[x]/\langle x^n-1 \rangle \).&amp;#160;&lt;a href=&#34;#fnref:7&#34; class=&#34;footnote-backref&#34; role=&#34;doc-backlink&#34;&gt;&amp;#x21a9;&amp;#xfe0e;&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li id=&#34;fn:8&#34; role=&#34;doc-endnote&#34;&gt;
&lt;p&gt;It is used to contruct the &lt;a href=&#34;https://en.wikipedia.org/wiki/Leech_lattice&#34;&gt;Leech lattice&lt;/a&gt;, the &lt;em&gt;densest&lt;/em&gt; packing of spheres in \(\mathbb{R}^{24}\)! Also see the (5,8,24) &lt;a href=&#34;https://en.wikipedia.org/wiki/Steiner_system#Construction_from_the_binary_Golay_code&#34;&gt;Steiner system&lt;/a&gt; for another rabbit hole.&amp;#160;&lt;a href=&#34;#fnref:8&#34; class=&#34;footnote-backref&#34; role=&#34;doc-backlink&#34;&gt;&amp;#x21a9;&amp;#xfe0e;&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li id=&#34;fn:9&#34; role=&#34;doc-endnote&#34;&gt;
&lt;p&gt;There is a truly marvelous proof of this, which the footnotes of this blog are too small to contain. But see &lt;a href=&#34;#references&#34;&gt;[1]&lt;/a&gt; Chapter 6.&amp;#160;&lt;a href=&#34;#fnref:9&#34; class=&#34;footnote-backref&#34; role=&#34;doc-backlink&#34;&gt;&amp;#x21a9;&amp;#xfe0e;&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/section&gt;
</description>
      
    </item>
    
    <item>
      <title>About</title>
      <link>https://meiji163.github.io/about/</link>
      <pubDate>Fri, 20 Aug 2021 21:38:52 +0800</pubDate>
      
      <guid>https://meiji163.github.io/about/</guid>
      
        <description>&lt;p&gt;HI I&amp;rsquo;m meiji163. I currently work on databases at GitHub.
Fun fact: 163 is the largest &lt;a href=&#34;https://en.wikipedia.org/wiki/Heegner_number&#34;&gt;Heegner number&lt;/a&gt;!&lt;/p&gt;
&lt;p&gt;Find me on &lt;a href=&#34;https://github.com/meiji163&#34;&gt;GitHub&lt;/a&gt; and &lt;a href=&#34;https://www.youtube.com/watch?v=oHg5SJYRHA0&#34;&gt;Twitter&lt;/a&gt;.
If anyone needs me I&amp;rsquo;ll be in &lt;em&gt;the Chamber of Understanding&lt;/em&gt;!&lt;/p&gt;

&lt;div style=&#34;position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;&#34;&gt;
  &lt;iframe src=&#34;https://www.youtube.com/embed/78kn2YBfHFw&#34; style=&#34;position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;&#34; allowfullscreen title=&#34;YouTube Video&#34;&gt;&lt;/iframe&gt;
&lt;/div&gt;

</description>
      
    </item>
    
    <item>
      <title>Fun With GitHub CLI Extensions</title>
      <link>https://meiji163.github.io/post/gh-extension/</link>
      <pubDate>Sat, 25 Dec 2021 00:00:00 +0000</pubDate>
      
      <guid>https://meiji163.github.io/post/gh-extension/</guid>
      
        <description>&lt;blockquote&gt;
&lt;p&gt;And everything else which can be attributed to body presupposes extension, and is only a mode of that which is extended.&lt;br&gt;
&amp;ndash; Descartes, &lt;em&gt;Principles of Philosophy&lt;/em&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&#34;introduction&#34;&gt;Introduction&lt;/h2&gt;
&lt;p&gt;&lt;code&gt;gh&lt;/code&gt; is the official GitHub CLI, maintained in the public &lt;a href=&#34;https://github.com/cli/cli&#34;&gt;cli/cli&lt;/a&gt; repository.&lt;br&gt;
Like its predecessor hub&lt;sup id=&#34;fnref:1&#34;&gt;&lt;a href=&#34;#fn:1&#34; class=&#34;footnote-ref&#34; role=&#34;doc-noteref&#34;&gt;1&lt;/a&gt;&lt;/sup&gt;, &lt;code&gt;gh&lt;/code&gt; wraps common git commands. But &lt;code&gt;gh&lt;/code&gt; does much more, ultimately aiming to be a general GitHub interface for your terminal.
You can for example run actions with &lt;code&gt;gh workflow&lt;/code&gt;, publish gists with &lt;code&gt;gh gist&lt;/code&gt;, or access your codespaces with &lt;code&gt;gh cs&lt;/code&gt;. If you don&amp;rsquo;t already have it, check out &lt;a href=&#34;https://cli.github.com/&#34;&gt;here&lt;/a&gt; to get started!&lt;/p&gt;
&lt;p&gt;Recently, I interned for the GitHub CLI team via the MLH Fellowship&lt;sup id=&#34;fnref:2&#34;&gt;&lt;a href=&#34;#fn:2&#34; class=&#34;footnote-ref&#34; role=&#34;doc-noteref&#34;&gt;2&lt;/a&gt;&lt;/sup&gt;.
I learned a great deal about software and golang from the senior devs (&lt;a href=&#34;https://github.com/vilmibm&#34;&gt;@vilmbim&lt;/a&gt;, &lt;a href=&#34;https://github.com/mislav&#34;&gt;@mislav&lt;/a&gt;, and &lt;a href=&#34;https://github.com/samcoe&#34;&gt;@samcoe&lt;/a&gt;).
I was also pleasantly surprised at how easy it was to use and contribute to the CLI. It has great user experience and a ton of features for using GitHub programmatically.&lt;/p&gt;
&lt;p&gt;However my favorite part of &lt;code&gt;gh&lt;/code&gt; is &lt;strong&gt;extensions&lt;/strong&gt;, which launched in v2.0. Extensions are programs that you can install, execute, and upgrade &amp;ndash; just like a mini package-manager!
If there&amp;rsquo;s any functionality you want that falls outside the scope of the core commands, you can find or make an extension that does just that.&lt;/p&gt;
&lt;h2 id=&#34;using-extensions&#34;&gt;Using extensions&lt;/h2&gt;
&lt;p&gt;&lt;code&gt;gh&lt;/code&gt; installs extensions from GitHub repositories with a &amp;ldquo;gh-&amp;rdquo; prefix (e.g. meiji163/gh-coolextension). All that&amp;rsquo;s required is a top-level executable with the same name as the repo. Once you install an extension, it creates a new top-level &lt;code&gt;gh&lt;/code&gt; command under that name aliased to that executable. Here is an example:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# install an extension by repo name &lt;/span&gt;
$ gh extension install vilmibm/gh-screensaver  

&lt;span class=&#34;c1&#34;&gt;# execute the extension&lt;/span&gt;
$ gh screensaver 

&lt;span class=&#34;c1&#34;&gt;# upgrade the extension&lt;/span&gt;
$ gh extensions upgrade screensaver
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;There is already a quickly growing ecosystem of extensions to choose from; when I started in mid-September there were less than 100, and at the time of writing there are &lt;a href=&#34;https://github.com/topics/gh-extension&#34;&gt;145&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;I love not only how useful, but also how creative and fun they are. Here&amp;rsquo;s a few of my favorites:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/dlvhdr/gh-prs&#34;&gt;dlvhdr/gh-prs&lt;/a&gt;: A slick dashboard of all your pull requests, with lots of configurability!&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img src=&#34;https://github.com/dlvhdr/gh-prs/blob/8621183574c573e4077360b5027ffea70999b921/demo.gif?raw=true&#34; alt=&#34;gh-prs&#34;&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href=&#34;https://github.com/vilmibm/gh-screensaver&#34;&gt;vilmibm/gh-screensaver&lt;/a&gt;: Cool and colorful terminal animations (I added the game of life one)
&lt;img src=&#34;https://user-images.githubusercontent.com/98482/134737341-701d0e7d-476f-4a29-8309-d34b4935c6a3.gif&#34; alt=&#34;gh-screensaver&#34;&gt;
&lt;img src=&#34;https://user-images.githubusercontent.com/98482/134737299-aa306b69-ceb4-49c1-95c8-3582d195250c.gif&#34; alt=&#34;gh firework&#34;&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href=&#34;https://github.com/yusukebe/gh-markdown-preview&#34;&gt;yusukebe/gh-markdown-preview&lt;/a&gt;: Renders your local md files with GitHub-flavored markdown in your browser. Super useful for writing readmes.
&lt;img src=&#34;https://user-images.githubusercontent.com/10682/138411417-dd12a831-bacc-4b05-a33d-47d3f6b45483.png&#34; alt=&#34;gh-markdown&#34;&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href=&#34;https://github.com/kawarimidoll/gh-graph&#34;&gt;kawarimidoll/gh-graph&lt;/a&gt;: View your contribution graph in the terminal
&lt;img src=&#34;https://user-images.githubusercontent.com/8146876/131276560-9b97596f-2f21-48ed-a946-498c47d9faf1.png&#34; alt=&#34;gh-grpah&#34;&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;writing-extensions&#34;&gt;Writing extensions&lt;/h2&gt;
&lt;p&gt;The CLI team made some tools to help write extensions (nice guys, eh?). Use the &lt;code&gt;gh extension create&lt;/code&gt; command and you&amp;rsquo;ll be prompted for the name and what kind of extension you want to make. A local git repository will then be created for you with some boilerplate.&lt;/p&gt;
&lt;p&gt;Extensions can be written in any language, but for our purpose languages are split into three categories: interpreted, Golang, and other compiled language. Here are a few key differences between them when writing extensions.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Interpreted&lt;/strong&gt;:
This requires the user to have the interpreter for the language (and any dependencies) installed. For that reason, most are written in bash, but it could be python, ruby, etc.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Compiled (not golang)&lt;/strong&gt;:
This allows you to distribute binaries from your extension repo.
Precompiled binary extensions are fully supported since gh version 2.3.0. That means if you publish a release with binary assets from your extension repo, &lt;code&gt;gh extension install&lt;/code&gt; will download the appropriate binary (instead of looking for a top-level executable).&lt;/p&gt;
&lt;p&gt;The binary assets have to be named as &amp;ldquo;platform-architecture&amp;rdquo; (e.g. darwin-arm64). Luckily @vilmibm recently made &lt;a href=&#34;https://github.com/cli/gh-extension-precompile&#34;&gt;gh-extension-precompile&lt;/a&gt;, a GitHub action that automates the building and releasing for you. Modify the build script for your language as needed.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Golang&lt;/strong&gt;: The stuff for compiled languages also applies here, but there&amp;rsquo;s even &lt;em&gt;more&lt;/em&gt; tools for golang! The CLI team recently open-sourced &lt;a href=&#34;https://github.com/cli/go-gh&#34;&gt;go-gh&lt;/a&gt;, a module for golang that exposes a small subset of cli/cli internals. This includes an HTTP client for both the REST and GraphQL API for GitHub. It also has an &lt;code&gt;Exec&lt;/code&gt; function that safely shells out to &lt;code&gt;gh&lt;/code&gt;, and a &lt;code&gt;CurrentRepository&lt;/code&gt; function. It&amp;rsquo;s still in beta, so there will likely be more functionality to come. See below for an example usage.&lt;/p&gt;
&lt;h3 id=&#34;github-apis&#34;&gt;GitHub APIs&lt;/h3&gt;
&lt;p&gt;One of the main reasons to write gh extensions is that you can easily make authenticated GitHub API calls (although your extension can be completely unrelated to GitHub) since the user will presumably have an auth token for &lt;code&gt;gh&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;A typical way would be to use the &lt;code&gt;gh api&lt;/code&gt; command. This command wraps both the REST and GraphQL GitHub API.
You can select format the response using jquery syntax with the &lt;code&gt;--jq&lt;/code&gt; flag, or (even better) with &lt;a href=&#34;https://golangdocs.com/templates-in-golang&#34;&gt;golang templates&lt;/a&gt; using the &lt;code&gt;--template&lt;/code&gt; flag.
Templates are quite powerful for text formatting. See &lt;code&gt;gh formatting help&lt;/code&gt; for more details on built-in functions and examples.&lt;/p&gt;
&lt;p&gt;For example, here is a script to print a table of a user&amp;rsquo;s starred repos:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;cp&#34;&gt;#!/usr/bin/bash
&lt;/span&gt;&lt;span class=&#34;cp&#34;&gt;&lt;/span&gt;gh api /users/&lt;span class=&#34;s2&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$USERNAME&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;&lt;/span&gt;/starred &lt;span class=&#34;se&#34;&gt;\
&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;&lt;/span&gt;    --template &lt;span class=&#34;s1&#34;&gt;&amp;#39;
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;    {{- tablerow &amp;#34;NAME&amp;#34; &amp;#34;DESCRIPTION&amp;#34; -}}
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;    {{- range .}}{{- tablerow .name .description -}}{{- end -}}&amp;#39;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;A little polishing, and this would be a fine bash gh-extension!&lt;/p&gt;
&lt;p&gt;If you&amp;rsquo;re using golang, you can use the clients from &lt;code&gt;go-gh&lt;/code&gt;. Here is how to get the same data as above:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-go&#34; data-lang=&#34;go&#34;&gt;&lt;span class=&#34;nx&#34;&gt;opts&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;api&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;ClientOptions&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;EnableCache&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;true&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;span class=&#34;nx&#34;&gt;client&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;err&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;gh&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;RESTClient&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;opts&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;err&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;!=&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;nil&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
    &lt;span class=&#34;nx&#34;&gt;log&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Fatal&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;err&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;span class=&#34;nx&#34;&gt;response&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[]&lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;struct&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt; 
    &lt;span class=&#34;nx&#34;&gt;Name&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;string&lt;/span&gt; 
    &lt;span class=&#34;nx&#34;&gt;Description&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;string&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;}{}&lt;/span&gt;
&lt;span class=&#34;nx&#34;&gt;err&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;client&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Get&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;fmt&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Sprintf&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;users/%s/starred&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;username&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;response&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;You can also use the GraphQL API (somewhat annoyingly, there are features not available in the REST API available in GraphQL and vice versa). Here is a query to get the same data once again:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-graphql&#34; data-lang=&#34;graphql&#34;&gt;&lt;span class=&#34;kd&#34;&gt;query&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nc&#34;&gt;GetStarredRepos&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$username&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nc&#34;&gt;String&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;!)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;py&#34;&gt;user&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;py&#34;&gt;login&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$username&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nc&#34;&gt;starredRepositories&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;py&#34;&gt;first&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nc&#34;&gt;100&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;py&#34;&gt;nodes&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;py&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;py&#34;&gt;description&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;GitHub has a &lt;a href=&#34;https://docs.github.com/en/graphql/overview/explorer&#34;&gt;great tool&lt;/a&gt; for exploring their GraphQL schema.
There is also a &lt;a href=&#34;https://github.com/shurcooL/githubv4&#34;&gt;GitHub GraphQL library&lt;/a&gt; for golang that provides a more concise interface.&lt;/p&gt;
&lt;h3 id=&#34;three-more-extensions&#34;&gt;Three more extensions&lt;/h3&gt;
&lt;p&gt;To conclude, I want to go over three extensions I wrote during my time on the CLI team.
They certainly aren&amp;rsquo;t the best quality since I wrote them while learning golang and gh, but hopefully they will serve as examples and perhaps give you ideas for your own extension &amp;ndash; &lt;em&gt;I&amp;rsquo;m eager to see what you make!&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;&lt;a href=&#34;https://github.com/meiji163/gh-notify&#34;&gt;gh-notify&lt;/a&gt;:&lt;/strong&gt;&lt;br&gt;
This one is pretty simple. It&amp;rsquo;s a bash script that fetches notifications and pipes it into &lt;a href=&#34;https://github.com/junegunn/fzf&#34;&gt;fzf&lt;/a&gt;.
If you select a notification linked to a pull request or issue, it will show it with the appropriate &lt;code&gt;gh&lt;/code&gt; command.
I wrote it for a hackday.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# show unread notifs&lt;/span&gt;
$ gh notify 

&lt;span class=&#34;c1&#34;&gt;# show first 10 of all notifs  &lt;/span&gt;
$ gh notify -a -n &lt;span class=&#34;m&#34;&gt;10&lt;/span&gt; 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;strong&gt;&lt;a href=&#34;https://github.com/meiji163/gh-search&#34;&gt;gh-search&lt;/a&gt;:&lt;/strong&gt;&lt;br&gt;
This extension provides access to the search API for repositories. It was a personal tool, as I&amp;rsquo;m frequently looking for great new projects on GitHub.&lt;/p&gt;
&lt;p&gt;It allows you to filter with &lt;code&gt;--lang&lt;/code&gt; or &lt;code&gt;--topic&lt;/code&gt; flags, or simply enter the raw search query in &lt;a href=&#34;https://docs.github.com/en/search-github/getting-started-with-searching-on-github/understanding-the-search-syntax&#34;&gt;GitHub syntax&lt;/a&gt; with the &lt;code&gt;-q&lt;/code&gt; flag.
It then shows you the results in a searchable scrolling menu.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# search for cli repos with hacktoberfest topic&lt;/span&gt;
$ gh search cli --topic&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;hacktoberfest

&lt;span class=&#34;c1&#34;&gt;# custom search with GitHub syntax&lt;/span&gt;
$ gh search -q&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;org:cli created:&amp;gt;2019-01-01&amp;#34;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;I wrote it in golang using go-gh and &lt;a href=&#34;https://github.com/spf13/cobra/&#34;&gt;cobra&lt;/a&gt;, a nice library for CLI apps (and the same one used in gh).&lt;/p&gt;
&lt;p&gt;Note that this extension will probably be obsolete&amp;rsquo;d once &lt;code&gt;gh&lt;/code&gt; adds search to the core commands (ref: &lt;a href=&#34;https://github.com/cli/cli/issues/4834&#34;&gt;cli#4834&lt;/a&gt;).&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;&lt;a href=&#34;https://github.com/meiji163/gh-spam&#34;&gt;gh-spam&lt;/a&gt;:&lt;/strong&gt;&lt;br&gt;
This extension is a simple classifier for spam issues (again in golang). I wrote it on the last hackday (they have a lot of hackdays at GitHub, which is great). During the internship I noticed a fairly large volume of spam issues on the cli/cli repo that had to be closed manually.
As an ML-inclined fellow, I thought I would take a crack at automating this.&lt;/p&gt;
&lt;p&gt;To use it, you first download a labeled dataset of issues from a target repo (this only really works if you have a large repo). Then you train a classifier on it, which by default is a &lt;a href=&#34;https://en.wikipedia.org/wiki/Random_forest&#34;&gt;random forest&lt;/a&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# download data from cli/cli repo &lt;/span&gt;
$ gh-spam download -R cli/cli

&lt;span class=&#34;c1&#34;&gt;# classify an issue &lt;/span&gt;
$ gh-spam classify -R cli/cli &lt;span class=&#34;m&#34;&gt;4894&lt;/span&gt;
&lt;span class=&#34;c1&#34;&gt;#4894: spam&lt;/span&gt;

&lt;span class=&#34;c1&#34;&gt;# classify multiple issues&lt;/span&gt;
$ gh-spam classify -R cli/cli &lt;span class=&#34;m&#34;&gt;4913&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;4907&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;4906&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;4894&lt;/span&gt;
&lt;span class=&#34;c1&#34;&gt;#4913: not spam&lt;/span&gt;
&lt;span class=&#34;c1&#34;&gt;#4907: not spam&lt;/span&gt;
&lt;span class=&#34;c1&#34;&gt;#4906: not spam&lt;/span&gt;
&lt;span class=&#34;c1&#34;&gt;#4894: spam&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Rather than do any fancy NLP on the issue content, the classifier inputs (aka features) are based primarily on the &amp;ldquo;reputation&amp;rdquo; of the author, i.e. number of contributions, association with the target repo, age of account, etc.
I also took into account issues which just post one of the issue templates without substantive change by using a string-matching score.
This approach turns out to be sufficiently accurate (at least for the cli/cli repo).&lt;/p&gt;
&lt;p&gt;Making this extension was particularly interesting, because I previously only used python for machine learning. I looked around for ML libraries in golang, and ended up using &lt;a href=&#34;https://github.com/sjwhitworth/golearn&#34;&gt;golearn&lt;/a&gt;. It has a nice API similar to scikit-learn, but in comparison it is pretty awkward for handling data, and has less clear documentation&lt;sup id=&#34;fnref:3&#34;&gt;&lt;a href=&#34;#fn:3&#34; class=&#34;footnote-ref&#34; role=&#34;doc-noteref&#34;&gt;3&lt;/a&gt;&lt;/sup&gt;.&lt;/p&gt;
&lt;h2 id=&#34;further-resources&#34;&gt;Further Resources&lt;/h2&gt;
&lt;p&gt;Here are a few more resources you may find useful.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://docs.github.com/en/github-cli/github-cli/creating-github-cli-extensions&#34;&gt;official GitHub guide&lt;/a&gt; for extensions&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://www.youtube.com/watch?v=tzK3ZuiEjcA&amp;amp;feature=youtu.be&amp;amp;ab_channel=vilmibm&#34;&gt;precompiled extension demo&lt;/a&gt; by @vilmibm&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://github.blog/2021-08-24-github-cli-2-0-includes-extensions/&#34;&gt;GitHub blogpost&lt;/a&gt; on extensions launch&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://cli.github.com/manual/&#34;&gt;manual&lt;/a&gt; for gh&lt;/li&gt;
&lt;/ul&gt;
&lt;section class=&#34;footnotes&#34; role=&#34;doc-endnotes&#34;&gt;
&lt;hr&gt;
&lt;ol&gt;
&lt;li id=&#34;fn:1&#34; role=&#34;doc-endnote&#34;&gt;
&lt;p&gt;&lt;a href=&#34;https://github.com/github/hub&#34;&gt;https://github.com/github/hub&lt;/a&gt;&amp;#160;&lt;a href=&#34;#fnref:1&#34; class=&#34;footnote-backref&#34; role=&#34;doc-backlink&#34;&gt;&amp;#x21a9;&amp;#xfe0e;&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li id=&#34;fn:2&#34; role=&#34;doc-endnote&#34;&gt;
&lt;p&gt;The MLH Fellowship is basically an internship done in small groups called pods. I thought it was fantastic! Learn more at &lt;a href=&#34;https://fellowship.mlh.io/&#34;&gt;https://fellowship.mlh.io/&lt;/a&gt;&amp;#160;&lt;a href=&#34;#fnref:2&#34; class=&#34;footnote-backref&#34; role=&#34;doc-backlink&#34;&gt;&amp;#x21a9;&amp;#xfe0e;&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li id=&#34;fn:3&#34; role=&#34;doc-endnote&#34;&gt;
&lt;p&gt;The documentation complaint is a &amp;ldquo;golang vs. python&amp;rdquo; complaint more than a &amp;ldquo;golearn vs. sklearn&amp;rdquo; complaint.&amp;#160;&lt;a href=&#34;#fnref:3&#34; class=&#34;footnote-backref&#34; role=&#34;doc-backlink&#34;&gt;&amp;#x21a9;&amp;#xfe0e;&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/section&gt;
</description>
      
    </item>
    
    <item>
      <title>Combinatorial Hyperbolic Embeddings</title>
      <link>https://meiji163.github.io/post/combo-hyperbolic-embedding/</link>
      <pubDate>Tue, 24 Aug 2021 00:00:00 +0000</pubDate>
      
      <guid>https://meiji163.github.io/post/combo-hyperbolic-embedding/</guid>
      
        <description>&lt;h2 id=&#34;introduction&#34;&gt;Introduction&lt;/h2&gt;
&lt;p&gt;The &lt;a href=&#34;http://colah.github.io/posts/2014-03-NN-Manifolds-Topology/#fnref1&#34;&gt;manifold hypothesis&lt;/a&gt; says that most real-world datasets lie approximately on a low-dimensional manifold,
but by some Kantian twist of fate we rarely have direct access to this manifold&lt;sup id=&#34;fnref:1&#34;&gt;&lt;a href=&#34;#fn:1&#34; class=&#34;footnote-ref&#34; role=&#34;doc-noteref&#34;&gt;1&lt;/a&gt;&lt;/sup&gt;. As a result, most machine learning techniques utilize only &lt;em&gt;local&lt;/em&gt; structure (e.g. the &amp;ldquo;loss + SGD&amp;rdquo; machine).&lt;/p&gt;
&lt;p&gt;In contrast, Topological and Geometric Data Analysis (TGDA) is a burgeoning field that studies the &lt;em&gt;global&lt;/em&gt; structure of data.
This is exciting not only because of potential domain applications &amp;ndash; it also opens possibilities for porting a lot of powerful and beautiful math to the ML realm.&lt;/p&gt;
&lt;p&gt;One aspect of TGDA is non-Euclidean representation learning. In this post I discuss hyperbolic learning, a research area that has been very active in recent years.
After introducing hyperbolic space and its connection to trees, I go over some developments in combinatorial methods for hyperbolic embeddings.
At the end, I produce some example embeddings using &lt;a href=&#34;https://github.com/nalexai/hyperlib&#34;&gt;Hyperlib&lt;/a&gt;.&lt;/p&gt;
&lt;h2 id=&#34;hyperbolic-space&#34;&gt;Hyperbolic Space&lt;/h2&gt;
&lt;p&gt;I usually find it difficult to explain hyperbolic space to the geometrically uninitiated (it generally involves me going on about Riemannian metrics and curvature tensors while gesturing wildly at Escher&amp;rsquo;s &lt;em&gt;Circle Limit&lt;/em&gt;).
The geometry of a sphere or plane is easy to grasp, but negative curvature is unintuitive to our Euclidean brains.&lt;/p&gt;

&lt;link rel=&#34;stylesheet&#34; href=&#34;https://meiji163.github.io/css/hugo-easy-gallery.css&#34; /&gt;
&lt;div class=&#34;box&#34;&gt;
&lt;figure  itemprop=&#34;associatedMedia&#34;
  itemscope itemtype=&#34;http://schema.org/ImageObject&#34; &gt;
    &lt;div class=&#34;img&#34;&gt;
      &lt;img itemprop=&#34;thumbnail&#34; src=&#34;https://uploads5.wikiart.org/images/m-c-escher/circle-limit-iv.jpg&#34; alt=&#34;M. C. Escher, Circle Limit IV&#34;/&gt;
    &lt;/div&gt;
    &lt;a href=&#34;https://uploads5.wikiart.org/images/m-c-escher/circle-limit-iv.jpg&#34; itemprop=&#34;contentUrl&#34;&gt;&lt;/a&gt;
      &lt;figcaption&gt;
          &lt;p&gt;M. C. Escher, Circle Limit IV&lt;/p&gt;
      &lt;/figcaption&gt;
  &lt;/figure&gt;
&lt;/div&gt;

&lt;p&gt;Luckily, I can explain it simply if you know what a &lt;a href=&#34;https://en.wikipedia.org/wiki/Tree_(graph_theory)&#34;&gt;tree&lt;/a&gt; is: hyperbolic space is a &lt;em&gt;continuous version of a tree&lt;/em&gt;.&lt;/p&gt;
&lt;p&gt;To see what this means I have to introduce a notion of hyperbolicity invented by the great mathematician &lt;a href=&#34;https://en.wikipedia.org/wiki/Mikhael_Gromov_(mathematician)&#34;&gt;Gromov&lt;/a&gt;, which he originally used in the context of geometric group theory.&lt;/p&gt;
&lt;h3 id=&#34;delta-hyperbolicity&#34;&gt;\(\delta\)-Hyperbolicity&lt;/h3&gt;
&lt;p&gt;Suppse \( X \) is a set of points and \(d(\cdot, \cdot)\) is a &lt;a href=&#34;https://en.wikipedia.org/wiki/Metric_space&#34;&gt;metric&lt;/a&gt; on \(X\) (a symmetric distance function that satisfies the triangle inequality).&lt;/p&gt;
&lt;p&gt;Define the &amp;ldquo;Gromov product&amp;rdquo; as&lt;/p&gt;
&lt;p&gt;$$ (x | y)_z = \frac{1}{2}(d(x,z)+d(y,z)-d(x,y)) $$&lt;/p&gt;
&lt;p&gt;Roughly, the Gromov product measures the distance of \(z\) from the shortest path (the geodesic) connecting \(x\) and \(y\).&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Definition&lt;/strong&gt;:  A metric space \( (X, d)\) is \(\delta\)-hyperbolic ( \(\delta \ge 0\) ) if&lt;/p&gt;
&lt;p&gt;$$ (x | y)_w \ge \min( (x|z)_w, (y|z)_w) - \delta \quad \text{for all } x,y,z,w \in X.$$&lt;/p&gt;
&lt;p&gt;This condition essentially says that no point in the triangle formed by \(x,y,z\) can be too far from one of the edges.
In fact, it&amp;rsquo;s equivalent to require all triangles in \(X\) to be &amp;ldquo;slim&amp;rdquo;&lt;sup id=&#34;fnref:2&#34;&gt;&lt;a href=&#34;#fn:2&#34; class=&#34;footnote-ref&#34; role=&#34;doc-noteref&#34;&gt;2&lt;/a&gt;&lt;/sup&gt;, where \( \delta \) is the &amp;ldquo;slimness&amp;rdquo; parameter.&lt;/p&gt;


&lt;div class=&#34;box&#34;&gt;
&lt;figure  itemprop=&#34;associatedMedia&#34;
  itemscope itemtype=&#34;http://schema.org/ImageObject&#34; &gt;
    &lt;div class=&#34;img&#34;&gt;
      &lt;img itemprop=&#34;thumbnail&#34; src=&#34;https://meiji163.github.io/images/deltah.png&#34; alt=&#34;The delta-hyperbolic condition in the Euclidean plane. The diagram shows incircles of the triangles xyw, xwz, and zyw. The length of the 3 red segments equal to the 3 Gromov products&#34;/&gt;
    &lt;/div&gt;
    &lt;a href=&#34;https://meiji163.github.io/images/deltah.png&#34; itemprop=&#34;contentUrl&#34;&gt;&lt;/a&gt;
      &lt;figcaption&gt;
          &lt;p&gt;The delta-hyperbolic condition in the Euclidean plane. The diagram shows incircles of the triangles xyw, xwz, and zyw. The length of the 3 red segments equal to the 3 Gromov products&lt;/p&gt;
      &lt;/figcaption&gt;
  &lt;/figure&gt;
&lt;/div&gt;

&lt;p&gt;What kind of space has slim triangles (small \(\delta\))? A &lt;em&gt;tree&lt;/em&gt;!&lt;br&gt;
For example, take an unweighted tree with its shortest-path distance.&lt;br&gt;
As a metric space it is 0-hyperbolic, i.e. \( (x|y)_w \ge \min( (y|z)_w, (z|x)_w ) \) &lt;br&gt;
(Proof: Exercise).&lt;/p&gt;


&lt;div class=&#34;box&#34;&gt;
&lt;figure  itemprop=&#34;associatedMedia&#34;
  itemscope itemtype=&#34;http://schema.org/ImageObject&#34; &gt;
    &lt;div class=&#34;img&#34;&gt;
      &lt;img itemprop=&#34;thumbnail&#34; src=&#34;https://graphstream-project.org/media/img/generator_overview_banana_tree.png#center&#34; /&gt;
    &lt;/div&gt;
    &lt;a href=&#34;https://graphstream-project.org/media/img/generator_overview_banana_tree.png#center&#34; itemprop=&#34;contentUrl&#34;&gt;&lt;/a&gt;
  &lt;/figure&gt;
&lt;/div&gt;

&lt;p&gt;A tree has no cycles, so every triangle is just a path &amp;ndash; a degenerate triangle. Trees are therefore the &lt;em&gt;most&lt;/em&gt; hyperbolic of spaces; 0-hyperbolic metrics are called &lt;em&gt;tree metrics&lt;/em&gt; (note however not all tree metrics come from a &lt;em&gt;tree graph&lt;/em&gt;).&lt;/p&gt;
&lt;p&gt;Now it&amp;rsquo;s easy to imagine graphs with a small \(\delta\): they&amp;rsquo;re the &amp;ldquo;tree-like&amp;rdquo; ones with few long cycles.&lt;/p&gt;
&lt;h3 id=&#34;poincaré-disk-model&#34;&gt;Poincaré Disk Model&lt;/h3&gt;
&lt;p&gt;Graphs are well and good for you discrete-ophiles, but we want continuous hyperbolic spaces with derivatives and stuff!&lt;/p&gt;
&lt;p&gt;There are many models of hyperbolic space&lt;sup id=&#34;fnref:3&#34;&gt;&lt;a href=&#34;#fn:3&#34; class=&#34;footnote-ref&#34; role=&#34;doc-noteref&#34;&gt;3&lt;/a&gt;&lt;/sup&gt;, but one of the easiest to visualize is the Poincaré model.
In 2 dimensions, it is the set of points in the Euclidean disk&lt;br&gt;
\( \mathbb{H}^2 = \{ x\in \mathbb{R}^2 : |x| &amp;lt; 1 \} \)  with the metric given by&lt;/p&gt;
&lt;p&gt;$$ d_H(x,y) = \cosh^{-1} \left(1 + 2\frac{|x-y|^2}{(1-|x|^2)(1-|y|^2)}\right).$$&lt;/p&gt;
&lt;p&gt;Nevermind where this crazy function comes from, just note that the distance gets huge near the boundary circle \( |x| \to 1 \) ( \( \cosh^{-1}(r) \sim \log(r) \) grows logarithmically ). &lt;br&gt;
Geodesics (shortest paths) in this model are arcs of circles that intersect the boundary circle at right angles. As a result, triangles look like this:&lt;/p&gt;


&lt;div class=&#34;box&#34;&gt;
&lt;figure  itemprop=&#34;associatedMedia&#34;
  itemscope itemtype=&#34;http://schema.org/ImageObject&#34; &gt;
    &lt;div class=&#34;img&#34;&gt;
      &lt;img itemprop=&#34;thumbnail&#34; src=&#34;https://pointatinfinityblog.files.wordpress.com/2018/02/triangle5.png?w=480&amp;amp;h=480#center&#34; /&gt;
    &lt;/div&gt;
    &lt;a href=&#34;https://pointatinfinityblog.files.wordpress.com/2018/02/triangle5.png?w=480&amp;amp;h=480#center&#34; itemprop=&#34;contentUrl&#34;&gt;&lt;/a&gt;
  &lt;/figure&gt;
&lt;/div&gt;

&lt;p&gt;To our Euclidean eyes, the triangles get smaller and more distorted towards the boundary, but all of these triangles are acutally the same size when measured with the Poincaré metric.
Space expands exponentially near the boundary unlike Euclidean space, which may give you an idea of why it is like a tree.&lt;/p&gt;
&lt;p&gt;As you might suspect, triangles in the Poincaré disk are &amp;ldquo;slim,&amp;rdquo; and it turns out this metric space is \(\delta\)-hyperbolic with \(\delta = \log(1+\sqrt{2}) \approx 0.881 \).
This model can be generalized easily to higher dimensions, and lower or higher \(\delta\). Other common models of hyperbolic space are the &lt;a href=&#34;https://en.wikipedia.org/wiki/Hyperboloid_model&#34;&gt;Lorentz model&lt;/a&gt; (or hyperboloid model) and the &lt;a href=&#34;https://en.wikipedia.org/wiki/Poincar%C3%A9_half-plane_model&#34;&gt;upper-halfspace model&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;I could go on for pages about hyperbolic space and its strange properties &amp;ndash; I refer the interested reader to one of the many good &lt;a href=&#34;http://library.msri.org/books/Book31/files/cannon.pdf&#34;&gt;introductory articles&lt;/a&gt;.&lt;/p&gt;
&lt;h2 id=&#34;hyperbolic-data&#34;&gt;Hyperbolic Data&lt;/h2&gt;
&lt;p&gt;Now that we&amp;rsquo;ve established a correspondence &amp;ldquo;hyperbolic&amp;rdquo; ⟷   &amp;ldquo;treelike,&amp;rdquo; you may be wondering what type of data is hyperbolic.&lt;/p&gt;
&lt;p&gt;The answer is: &lt;em&gt;anything with a hierarchical structure&lt;/em&gt;. Words, social networks, the Internet, knowledge graphs, genomic data, images, even financial data &amp;ndash; and that&amp;rsquo;s only the tip of the iceberg (see &lt;a href=&#34;#references&#34;&gt;[5,6,8,9,10,11]&lt;/a&gt; and the references therein).&lt;/p&gt;
&lt;p&gt;One way to understand the hyperbolic structure of these data is in terms of categorization (or &lt;a href=&#34;https://en.wikipedia.org/wiki/Hierarchical_clustering&#34;&gt;hierarchical clustering&lt;/a&gt; for you ML people). Often there is a hierarchy of categories that gives rise to an underlying tree (Henri is a human; a human is a primate). However, we may get something that is only approximately a tree due to heterogenous or overlapping categories (Henri is a human; Henri is a mathematician; a mathematician is a human).&lt;/p&gt;
&lt;p&gt;We therefore might expect many datasets to have a \( \delta \)-hyperbolic metric (this is indeed the case, and we can measure \( \delta \) directly).
This leads to the idea of embedding data in hyperbolic space.&lt;/p&gt;
&lt;h3 id=&#34;the-embedding-problem&#34;&gt;The Embedding Problem&lt;/h3&gt;
&lt;p&gt;The problem is now an algorithmic one: given data, compute a hyperbolic representation. A large portion of hyperbolic learning research focuses on this problem.&lt;/p&gt;
&lt;p&gt;For data with a natural metric, it can be formulated as follows:
&lt;em&gt;given data \(X \) with a metric \( d \) find an embedding \(f: (X,d) \to (\mathbb{H}, d_H) \)&lt;/em&gt; where \( (\mathbb{H}, d_H ) \) is a model of hyperbolic space.
The embedding should have &amp;ldquo;low distortion&amp;rdquo; by some measure; a common choice is the &lt;em&gt;average distortion&lt;/em&gt;, defined by&lt;/p&gt;
&lt;p&gt;$$D_{avg} = \frac{1}{\binom{n}{2}} \sum_{x,y\in X} \frac{|d_H(f(x),f(y)) - d(x,y)|}{d(x,y)}$$&lt;/p&gt;
&lt;p&gt;where the sum is over distinct pairs \( \{x,y\} \) and \(n\) is the number of points in \(X\).
Another measure is the worst-case distortion, defined by ratio of the maximum &amp;ldquo;stretch&amp;rdquo; \(d_H(f(x),f(y)) / d(x,y)\) to the minimum stretch.
If one only cares about preserving neighborhoods (i.e. &lt;a href=&#34;https://en.wikipedia.org/wiki/Voronoi_diagram&#34;&gt;Voronoi cells&lt;/a&gt;) then a different measure called the mean average precision is used.&lt;/p&gt;
&lt;p&gt;There are two main strategies to find an embedding:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;(&lt;strong&gt;SGD&lt;/strong&gt;) Use a loss function and gradient descent to learn the embedding&lt;/li&gt;
&lt;li&gt;(&lt;strong&gt;Combinatorial&lt;/strong&gt;) Embed the data into a (weighted) tree, then embed the tree in hyperbolic space&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;The SGD strategy for hyperbolic embeddings was pioneered by Nickel &amp;amp; Kiela &lt;a href=&#34;#references&#34;&gt;[3,4]&lt;/a&gt;, who demonstrated that datasets like &lt;a href=&#34;https://wordnet.princeton.edu/&#34;&gt;WordNet&lt;/a&gt; can be embedded in hyperbolic space with low distortion &lt;em&gt;and&lt;/em&gt; in low dimensions. The drawback of the SGD stategy is the computational cost and numerical instability of doing gradient descent with the Riemannian gradient (this is a problem for hyperbolic deep learning in general).&lt;/p&gt;
&lt;p&gt;For the remainder of this post I&amp;rsquo;ll primarily talk about the combinatorial strategy.&lt;/p&gt;
&lt;h3 id=&#34;get-in-the-tree&#34;&gt;Get in the Tree!&lt;/h3&gt;
&lt;p&gt;The second part of combinatorial strategy (embed a tree in hyperbolic space) is easy. An algorithm by Sarkar &lt;a href=&#34;#references&#34;&gt;[2]&lt;/a&gt; embeds a tree with \(n\) nodes in the Poincaré disk in \( O(n) \) time. It guarantees that the worst-case distortion is at most \( 1+\epsilon \) if the edge weights are scaled appropriately (by contrast, a tree with constant branching factor &amp;ndash; or more generally an &lt;a href=&#34;https://en.wikipedia.org/wiki/Expander_graph&#34;&gt;expander graph&lt;/a&gt; &amp;ndash; cannot be embedded with constant distortion in Euclidean space &lt;em&gt;of any dimension&lt;/em&gt;).&lt;/p&gt;
&lt;p&gt;The idea of Sarkar&amp;rsquo;s algorithm is simple: place a node at the origin and place all its children equally spaced in a circle around it. Then move one of the children to the origin (by a hyperbolic &lt;a href=&#34;https://en.wikipedia.org/wiki/Hyperbolic_motion&#34;&gt;reflection&lt;/a&gt;) and repeat.&lt;/p&gt;
&lt;p&gt;Here&amp;rsquo;s an example of an embedding of a complete binary tree in the Poincaré disk that achieves an average distortion of 0.153:&lt;/p&gt;


&lt;div class=&#34;box&#34;&gt;
&lt;figure  itemprop=&#34;associatedMedia&#34;
  itemscope itemtype=&#34;http://schema.org/ImageObject&#34; &gt;
    &lt;div class=&#34;img&#34;&gt;
      &lt;img itemprop=&#34;thumbnail&#34; src=&#34;https://meiji163.github.io/images/hyp-bin-tree.png&#34; /&gt;
    &lt;/div&gt;
    &lt;a href=&#34;https://meiji163.github.io/images/hyp-bin-tree.png&#34; itemprop=&#34;contentUrl&#34;&gt;&lt;/a&gt;
  &lt;/figure&gt;
&lt;/div&gt;

&lt;p&gt;The authors of &lt;a href=&#34;#references&#34;&gt;[1]&lt;/a&gt; provided a generalization of Sarkar&amp;rsquo;s algorithm to higher dimensions. The only downside of Sarkar&amp;rsquo;s algorithm is it requires high precision float arithmetic (as the points tend to the boundary).&lt;/p&gt;
&lt;p&gt;Now we can address the first part of the combinatorial strategy (embed the data into a tree), which is the more interesting problem.&lt;/p&gt;
&lt;p&gt;Many of the algorithms start from the following construction:&lt;/p&gt;
&lt;p&gt;For three points \(x,y,z \in X\) form a tree by adding a new point \(t\) and edges \( ( t,x), (t,y), (t,z)\).
In order to stay consistent with the original metric on \(X\), you&amp;rsquo;ll find that the edge weights have to be&lt;/p&gt;
&lt;p&gt;$$
\begin{aligned}
d(t,x) &amp;amp;= (y|z)_x\cr
d(t,y) &amp;amp;= (x|z)_y\cr
d(t,z) &amp;amp;= (x|y)_z.
\end{aligned}
$$&lt;/p&gt;
&lt;p&gt;\(t\) is called a &lt;em&gt;Steiner node&lt;/em&gt; and the 4-node tree is sometimes called a &lt;em&gt;Steiner tree&lt;/em&gt;. Following the previous discussion, it may be interpreted as a category or cluster, depending on the data.&lt;/p&gt;
&lt;p&gt;To illustrate this, suppose \(d(x,y) = d(y,z) = d(z,x) = 1 \). To form the Steiner tree we add a Steiner node at a distance 1/2 from \(x,y,\) and \(z\).&lt;/p&gt;


&lt;div class=&#34;box&#34;&gt;
&lt;figure  itemprop=&#34;associatedMedia&#34;
  itemscope itemtype=&#34;http://schema.org/ImageObject&#34; &gt;
    &lt;div class=&#34;img&#34;&gt;
      &lt;img itemprop=&#34;thumbnail&#34; src=&#34;https://meiji163.github.io/images/steiner.png#center&#34; alt=&#34;Forming a tree from a cycle by adding a Steiner node&#34;/&gt;
    &lt;/div&gt;
    &lt;a href=&#34;https://meiji163.github.io/images/steiner.png#center&#34; itemprop=&#34;contentUrl&#34;&gt;&lt;/a&gt;
      &lt;figcaption&gt;
          &lt;p&gt;Forming a tree from a cycle by adding a Steiner node&lt;/p&gt;
      &lt;/figcaption&gt;
  &lt;/figure&gt;
&lt;/div&gt;

&lt;p&gt;A relatively old algorithm that uses this idea is &lt;a href=&#34;https://en.wikipedia.org/wiki/Neighbor_joining&#34;&gt;Neighbor Joining&lt;/a&gt;, which is typically used in bioinformatics for constructing phylogenetic trees from some measure of genetic distance between species. Abraham et al. &lt;a href=&#34;#references&#34;&gt;[12]&lt;/a&gt; improved the construction and obtained precise bounds on the worst-case distortion for tree-like metric spaces&lt;sup id=&#34;fnref:4&#34;&gt;&lt;a href=&#34;#fn:4&#34; class=&#34;footnote-ref&#34; role=&#34;doc-noteref&#34;&gt;4&lt;/a&gt;&lt;/sup&gt;.&lt;/p&gt;
&lt;p&gt;Recently, Sonthalia &amp;amp; Gilbert &lt;a href=&#34;#references&#34;&gt;[7]&lt;/a&gt; introduced an algorithm called TreeRep to construct a tree from a \(\delta\)-hyperbolic metric. The idea is to start with the Steiner tree on \(x,y,z,t\) as above, sort the remaining points into zones based on their distance to the Steiner tree, then recursively add them to the tree.&lt;/p&gt;
&lt;p&gt;TreeRep reconstructs 0-hyperbolic metrics perfectly, but there is unfortunately no distortion bound for \(\delta &amp;gt; 0\). However, empirically TreeRep outperforms other combinatorial methods (as well SGD methods) on both speed and distortion.&lt;/p&gt;
&lt;p&gt;Variations on these ideas are still inspiring new algorithms for hyperbolic embeddings (particularly interesting is &lt;a href=&#34;#references&#34;&gt;[13]&lt;/a&gt; ).&lt;/p&gt;
&lt;h3 id=&#34;examples-with-hyperlib&#34;&gt;Examples with Hyperlib&lt;/h3&gt;
&lt;p&gt;Finally, here are a couple examples of combinatorial embeddings using &lt;a href=&#34;https://github.com/nalexai/hyperlib&#34;&gt;Hyperlib&lt;/a&gt;,
a library for hyperbolic learning I&amp;rsquo;m contributing to.&lt;/p&gt;
&lt;p&gt;As I mentioned before, a classic application of tree embedding is the construction of phylogenetic trees.
Sarich &lt;a href=&#34;#references&#34;&gt;[14]&lt;/a&gt; measured the &amp;ldquo;immunological distance&amp;rdquo; between 8 species of mammals. Let&amp;rsquo;s embed them in hyperbolic space with TreeRep and Sarkar&amp;rsquo;s algorithm&lt;sup id=&#34;fnref:5&#34;&gt;&lt;a href=&#34;#fn:5&#34; class=&#34;footnote-ref&#34; role=&#34;doc-noteref&#34;&gt;5&lt;/a&gt;&lt;/sup&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;numpy&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;as&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;np&lt;/span&gt;
&lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;networkx&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;as&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;nx&lt;/span&gt;
&lt;span class=&#34;kn&#34;&gt;from&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;hyperlib.embedding.graph&lt;/span&gt; &lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; 

&lt;span class=&#34;n&#34;&gt;labels&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;dog&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;bear&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;raccoon&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;weasel&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
          &lt;span class=&#34;mi&#34;&gt;4&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;seal&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;5&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;sea lion&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;6&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;cat&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;7&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;monkey&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;metric&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;np&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;array&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;([&lt;/span&gt; 
        &lt;span class=&#34;mf&#34;&gt;32.&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;  &lt;span class=&#34;mf&#34;&gt;48.&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;  &lt;span class=&#34;mf&#34;&gt;51.&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;  &lt;span class=&#34;mf&#34;&gt;50.&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;  &lt;span class=&#34;mf&#34;&gt;48.&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;  &lt;span class=&#34;mf&#34;&gt;98.&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mf&#34;&gt;148.&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;  
        &lt;span class=&#34;mf&#34;&gt;26.&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;  &lt;span class=&#34;mf&#34;&gt;34.&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;  &lt;span class=&#34;mf&#34;&gt;29.&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;  &lt;span class=&#34;mf&#34;&gt;33.&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mf&#34;&gt;84.&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mf&#34;&gt;136.&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;  
        &lt;span class=&#34;mf&#34;&gt;42.&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;  &lt;span class=&#34;mf&#34;&gt;44.&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;  &lt;span class=&#34;mf&#34;&gt;44.&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;  &lt;span class=&#34;mf&#34;&gt;92.&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mf&#34;&gt;152.&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;  
        &lt;span class=&#34;mf&#34;&gt;44.&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;  &lt;span class=&#34;mf&#34;&gt;38.&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;  &lt;span class=&#34;mf&#34;&gt;86.&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mf&#34;&gt;142.&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
        &lt;span class=&#34;mf&#34;&gt;24.&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;  &lt;span class=&#34;mf&#34;&gt;89.&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mf&#34;&gt;142.&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;  
        &lt;span class=&#34;mf&#34;&gt;90.&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mf&#34;&gt;142.&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; 
        &lt;span class=&#34;mf&#34;&gt;148.&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;])&lt;/span&gt;

&lt;span class=&#34;n&#34;&gt;T&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;treerep&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;metric&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; 
&lt;span class=&#34;n&#34;&gt;G&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;to_networkx&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;T&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;#convert to a nx.Graph&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;embed&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;sarkar_embedding&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;G&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;12&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;tau&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mf&#34;&gt;0.2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;precision&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;80&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;plot_embedding&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;G&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;emb&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;labels&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;labels&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Here&amp;rsquo;s the resulting tree:&lt;/p&gt;


&lt;div class=&#34;box&#34;&gt;
&lt;figure  itemprop=&#34;associatedMedia&#34;
  itemscope itemtype=&#34;http://schema.org/ImageObject&#34; &gt;
    &lt;div class=&#34;img&#34;&gt;
      &lt;img itemprop=&#34;thumbnail&#34; src=&#34;https://meiji163.github.io/images/sarich.png&#34; /&gt;
    &lt;/div&gt;
    &lt;a href=&#34;https://meiji163.github.io/images/sarich.png&#34; itemprop=&#34;contentUrl&#34;&gt;&lt;/a&gt;
  &lt;/figure&gt;
&lt;/div&gt;

&lt;p&gt;The real evolutionary tree looks like &lt;a href=&#34;https://en.wikipedia.org/wiki/Evolution_of_mammals#Evolution_of_major_groups_of_living_mammals&#34;&gt;this&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Here&amp;rsquo;s the code to plot the embedding:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;matplotlib.pyplot&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;as&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;plt&lt;/span&gt;
&lt;span class=&#34;kn&#34;&gt;from&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;matplot.collections&lt;/span&gt; &lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;LineCollection&lt;/span&gt;

&lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;plot_embedding&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;G&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;embedding&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;**&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;kwargs&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
    &lt;span class=&#34;n&#34;&gt;pts&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;np&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;array&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;list&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;map&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;float&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;embedding&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)))&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;reshape&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
    &lt;span class=&#34;n&#34;&gt;size&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;kwargs&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;get&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;figsize&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;15&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;15&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
    &lt;span class=&#34;n&#34;&gt;plt&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;figure&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;figsize&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;size&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
    &lt;span class=&#34;n&#34;&gt;labels&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;kwargs&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;get&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;labels&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;None&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;labels&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
        &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;labels&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
            &lt;span class=&#34;n&#34;&gt;plt&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;annotate&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;labels&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;],&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;pts&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;],&lt;/span&gt;
                         &lt;span class=&#34;n&#34;&gt;size&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;14&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
                         &lt;span class=&#34;n&#34;&gt;bbox&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;dict&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;facecolor&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;grey&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;alpha&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mf&#34;&gt;0.1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;

    &lt;span class=&#34;n&#34;&gt;lines&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;pts&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;e&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]],&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;pts&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;e&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]])&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;e&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;G&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;edges&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
    &lt;span class=&#34;n&#34;&gt;lc&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;LineCollection&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;lines&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;linewidths&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mf&#34;&gt;0.7&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
    &lt;span class=&#34;n&#34;&gt;circle&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;plt&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Circle&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;((&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;r&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;fill&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;kc&#34;&gt;False&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;color&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;b&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
    &lt;span class=&#34;n&#34;&gt;plt&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;gca&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;add_artist&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;circle&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
    &lt;span class=&#34;n&#34;&gt;plt&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;gca&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;set_aspect&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;equal&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
    &lt;span class=&#34;n&#34;&gt;plt&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;xlim&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mf&#34;&gt;1.1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mf&#34;&gt;1.1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
    &lt;span class=&#34;n&#34;&gt;plt&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ylim&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mf&#34;&gt;1.1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mf&#34;&gt;1.1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
    &lt;span class=&#34;n&#34;&gt;size&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;kwargs&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;get&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;node_size&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;10&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
    &lt;span class=&#34;n&#34;&gt;plt&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;scatter&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;pts&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[:,&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;],&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;pts&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[:,&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;],&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;s&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;size&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
    &lt;span class=&#34;n&#34;&gt;plt&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;gca&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;add_collection&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;lc&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
    &lt;span class=&#34;n&#34;&gt;plt&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;axis&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;off&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
    &lt;span class=&#34;n&#34;&gt;plt&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;show&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;For a bigger dataset, let&amp;rsquo;s look at the hyperlink graph for .edu sites, available &lt;a href=&#34;https://networkrepository.com/web-edu.php&#34;&gt;here&lt;/a&gt;.
Let&amp;rsquo;s also measure the \(\delta\) constant for the data and the average distortion of the embedding.
Note that TreeRep is a randomized algorithm, so you can generate multiple trees and take the best one.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;kn&#34;&gt;from&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;scipy.sparse.csgraph&lt;/span&gt; &lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;shortest_path&lt;/span&gt;
&lt;span class=&#34;kn&#34;&gt;from&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;scipy.spatial.distance&lt;/span&gt; &lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;squareform&lt;/span&gt;
&lt;span class=&#34;kn&#34;&gt;from&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;hyperlib.embedding.metric&lt;/span&gt; &lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;delta_rel&lt;/span&gt;

&lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;distortion&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;tree&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;metric&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
	&lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;#39;&amp;#39;Find the average distortion of the tree embedding for n points&amp;#39;&amp;#39;&amp;#39;&lt;/span&gt;
	&lt;span class=&#34;n&#34;&gt;M&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;to_sparse&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;tree&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
	&lt;span class=&#34;n&#34;&gt;tree_metric&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;squareform&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;shortest_path&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;M&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;directed&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;kc&#34;&gt;False&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)[:&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,:&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
	&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;np&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;mean&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;np&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;abs&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;tree_metric&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;metric&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;/&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;metric&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;

&lt;span class=&#34;n&#34;&gt;adj_mat&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;sp&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;io&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;mmread&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;web-edu.mtx&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;# load adjacency matrix&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;metric&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;shortest_path&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;adj_mat&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;# compute the graph metric&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;delta_r&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;delta_rel&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;metric&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[:&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1000&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,:&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1000&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;])&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;# estimate the relative delta constant&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;metric&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;squareform&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;metric&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;

&lt;span class=&#34;c1&#34;&gt;# generate 10 embeddings&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;_&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;range&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;10&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
	&lt;span class=&#34;n&#34;&gt;T&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;treerep&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;metric&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
	&lt;span class=&#34;nb&#34;&gt;print&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;distortion&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;T&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;metric&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;adj_mat&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;shape&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;])&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;The best average distortion I got out of the 10 tries was 0.0492. The relative \(\delta\) (i.e. normalized by the maximum distance) is approximately 0.2.&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;&lt;em&gt;Thanks for reading, stay tuned for more!&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;Interested in hyperbolic deep learning or want to contribute to Hyperlib? &lt;br&gt;
Join us at &lt;a href=&#34;https://www.nalex.ai/&#34;&gt;nalex.ai&lt;/a&gt;! You can contact Nathan at &lt;a href=&#34;mailto:nathan.francis@nalex.ai&#34;&gt;nathan.francis@nalex.ai&lt;/a&gt; and Alex at &lt;a href=&#34;mailto:alexander.joseph@nalex.ai&#34;&gt;alexander.joseph@nalex.ai&lt;/a&gt;.&lt;/p&gt;
&lt;h2 id=&#34;references&#34;&gt;References&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://arxiv.org/abs/1804.03329&#34;&gt;[1]&lt;/a&gt; C. De Sa, A. Gu, C. Ré, F. Sala, &lt;em&gt;Representation Tradeoffs for Hyperbolic Embeddings&lt;/em&gt;
&lt;a href=&#34;https://homepages.inf.ed.ac.uk/rsarkar/papers/HyperbolicDelaunayFull.pdf&#34;&gt;[2]&lt;/a&gt; R. Sarkar, &lt;em&gt;Low Distortion Delaunay Embedding of Trees in
Hyperbolic Plane&lt;/em&gt;  &lt;br&gt;
&lt;a href=&#34;https://arxiv.org/abs/1705.08039&#34;&gt;[3]&lt;/a&gt; M. Nickel &amp;amp; D. Kiela, &lt;em&gt;Poincaré Embeddings for Learning Hierarchical Representations&lt;/em&gt;  &lt;br&gt;
&lt;a href=&#34;https://arxiv.org/abs/1806.03417&#34;&gt;[4]&lt;/a&gt; M. Nickel &amp;amp; D. Kiela, &lt;em&gt;Learning Continuous Hierarchies in the Lorentz Model of Hyperbolic Geometry&lt;/em&gt;  &lt;br&gt;
&lt;a href=&#34;https://arxiv.org/abs/2005.00545v1&#34;&gt;[5]&lt;/a&gt; I. Chami, A. Wolf, D. Juan, F. Sala, S. Ravi, C. Ré, &lt;em&gt;Low-Dimensional Hyperbolic Knowledge Graph Embeddings&lt;/em&gt;  &lt;br&gt;
&lt;a href=&#34;https://arxiv.org/abs/1904.02239&#34;&gt;[6]&lt;/a&gt; V. Khrulkov, L. Mirvakhabova, E. Ustinova, I. Oseledets, V. Lempitsky, &lt;em&gt;Hyperbolic Image Embeddings&lt;/em&gt;  &lt;br&gt;
&lt;a href=&#34;https://arxiv.org/abs/2005.03847&#34;&gt;[7]&lt;/a&gt; R. Sonthalia, A. C. Gilbert, &lt;em&gt;Tree! I am no Tree! I am a Low Dimensional Hyperbolic Embedding&lt;/em&gt;  &lt;br&gt;
&lt;a href=&#34;https://arxiv.org/abs/1810.06546&#34;&gt;[8]&lt;/a&gt; A. Tifrea, G. Bécigneul, O. Ganea, &lt;em&gt;Poincaré GloVe: Hyperbolic Word Embeddings&lt;/em&gt; &lt;br&gt;
&lt;a href=&#34;https://arxiv.org/abs/1804.01882&#34;&gt;[9]&lt;/a&gt; O. Ganea, G. Bécigneul, T. Hofmann, &lt;em&gt;Hyperbolic Entailment Cones for Learning Hierarchical Embeddings&lt;/em&gt; &lt;br&gt;
&lt;a href=&#34;https://arxiv.org/abs/1006.5169&#34;&gt;[10]&lt;/a&gt; D. Krioukov, F. Papadopoulos, M. Kitsak, A. Vahdat, M. Boguna, &lt;em&gt;Hyperbolic Geometry of Complex Networks&lt;/em&gt;&lt;br&gt;
&lt;a href=&#34;https://dl.acm.org/doi/10.1145/3442381.3450095&#34;&gt;[11]&lt;/a&gt; R. Sawhney, S. Agarwal, A. Wadhwa, R. R. Shah, &lt;em&gt;Exploring the Scale-Free Nature of Stock Markets: Hyperbolic Graph Learning for Algorithmic Trading&lt;/em&gt; &lt;br&gt;
&lt;a href=&#34;http://www.cs.yale.edu/homes/mahesh/papers/approx-tree.pdf&#34;&gt;[12]&lt;/a&gt; I. Abraham, M. Balakrishnan, F. Kuhn et al., &lt;em&gt;Reconstructing Approximate Tree Metrics&lt;/em&gt;
&lt;a href=&#34;https://arxiv.org/abs/2010.00402&#34;&gt;[13]&lt;/a&gt; I. Chami, A. Gu, A. Chatziafratis, C. Ré, &lt;em&gt;From Trees to Continuous Embeddings and Back: Hyperbolic Hierarchical Clustering&lt;/em&gt; &lt;br&gt;
&lt;a href=&#34;https://www.jstor.org/stable/2412185&#34;&gt;[14]&lt;/a&gt; V. Sarich, &lt;em&gt;Pinniped Phylogeny&lt;/em&gt;&lt;/p&gt;
&lt;section class=&#34;footnotes&#34; role=&#34;doc-endnotes&#34;&gt;
&lt;hr&gt;
&lt;ol&gt;
&lt;li id=&#34;fn:1&#34; role=&#34;doc-endnote&#34;&gt;
&lt;p&gt;In some low-dimensional cases it is tractable. A notable experiment by Carlsson showed that 3x3 pixel patches on a dataset of black and white photos lay on a &lt;a href=&#34;https://en.wikipedia.org/wiki/Klein_bottle&#34;&gt;Klein bottle&lt;/a&gt; in \( \mathbb{R}^9 \)&amp;#160;&lt;a href=&#34;#fnref:1&#34; class=&#34;footnote-backref&#34; role=&#34;doc-backlink&#34;&gt;&amp;#x21a9;&amp;#xfe0e;&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li id=&#34;fn:2&#34; role=&#34;doc-endnote&#34;&gt;
&lt;p&gt;The definition of \(\delta\)-hyperbolic works for any metric space (which is a very general notion). For simplicity we can assume \(X\) has nice enough properties,
like being a &lt;a href=&#34;https://en.wikipedia.org/wiki/Intrinsic_metric&#34;&gt;geodesic space&lt;/a&gt;. In that case, the &amp;ldquo;slimness&amp;rdquo; of geodesic triangles is indeed an equivalent definition (called the Rips condition).&amp;#160;&lt;a href=&#34;#fnref:2&#34; class=&#34;footnote-backref&#34; role=&#34;doc-backlink&#34;&gt;&amp;#x21a9;&amp;#xfe0e;&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li id=&#34;fn:3&#34; role=&#34;doc-endnote&#34;&gt;
&lt;p&gt;More specifically, by &amp;ldquo;hyperbolic space&amp;rdquo; I mean the (unique) complete \(n\)-dimensional Riemannian manifold with constant negative scalar curvature -1.
Note that &amp;ldquo;hyperbolicity&amp;rdquo; as defined here can apply to any metric space, but most people will be thinking of the Riemannian manifold if you say &amp;ldquo;hyperbolic space.&amp;rdquo;&amp;#160;&lt;a href=&#34;#fnref:3&#34; class=&#34;footnote-backref&#34; role=&#34;doc-backlink&#34;&gt;&amp;#x21a9;&amp;#xfe0e;&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li id=&#34;fn:4&#34; role=&#34;doc-endnote&#34;&gt;
&lt;p&gt;They actually use a slightly different condition from \(\delta\)-hyperbolicity which they call the &amp;ldquo;\(\epsilon\) &amp;ndash; 4 points condition.&amp;rdquo; This condition is invariant under scaling unlike \(\delta\)-hyperbolicity. The conditions coincide for \(\delta=\epsilon=0\).&amp;#160;&lt;a href=&#34;#fnref:4&#34; class=&#34;footnote-backref&#34; role=&#34;doc-backlink&#34;&gt;&amp;#x21a9;&amp;#xfe0e;&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li id=&#34;fn:5&#34; role=&#34;doc-endnote&#34;&gt;
&lt;p&gt;At the time of writing &lt;code&gt;sarkar_embedding&lt;/code&gt; is only on &lt;a href=&#34;https://github.com/meiji163/hyperlib&#34;&gt;this fork&lt;/a&gt; of Hyperlib.&amp;#160;&lt;a href=&#34;#fnref:5&#34; class=&#34;footnote-backref&#34; role=&#34;doc-backlink&#34;&gt;&amp;#x21a9;&amp;#xfe0e;&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/section&gt;
</description>
      
    </item>
    
    <item>
      <title>Context Tree Weighting and Compression</title>
      <link>https://meiji163.github.io/post/context-tree-weighting/</link>
      <pubDate>Fri, 23 Apr 2021 00:00:00 +0000</pubDate>
      
      <guid>https://meiji163.github.io/post/context-tree-weighting/</guid>
      
        <description>&lt;p&gt;In this post I go over the basics of data compression with arithmetic coding and describe the Context Tree Weighting algorithm. At the end I discuss implementation and some experimental results.&lt;/p&gt;
&lt;h2 id=&#34;information-theory-review&#34;&gt;Information Theory Review&lt;/h2&gt;
&lt;p&gt;First a quick review of information theory.
Suppose that we receive some data \(x\) drawn from a discrete random variable \(X\), whose probability distribution is \(P\). Then the Shannon information content of \(x\) is defined as&lt;/p&gt;
&lt;p&gt;$$I(x) = -\log(P(x)).$$&lt;/p&gt;
&lt;p&gt;Why is this a good measure of information? Basically, it formalizes the idea that less probable events yield more information, and conversely predictable events yield less information.&lt;/p&gt;
&lt;p&gt;Given an incomplete message like &lt;code&gt;Hello Worl&lt;/code&gt; you&amp;rsquo;d assign a high probability (say 95%) that the next character is &amp;ldquo;&lt;em&gt;d&lt;/em&gt;&amp;rdquo;. Finding out that the next character is indeed &amp;ldquo;&lt;em&gt;d&lt;/em&gt;&amp;rdquo; would only give you about 0.07 units of information (also called shannons), since you in a sense already knew that.&lt;/p&gt;
&lt;p&gt;The Shannon entropy is defined as the expected value of information $$H(X) = \sum_x -P(x)\log(P(x)).$$
It can be thought of as a measure of how predictable the data is on average.
Now suppose we want to compress a stream of data.&lt;br&gt;
Formally, we want a code \(C: \mathcal{A} \to \text{ \{0, 1\} } ^* \) where \(\mathcal{A}\) is the alphabet the data comes from (e.g. ASCII characters) and \(\text{\{0, 1\} }^*\) is the set of all binary strings. A good code should have two properties:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;\(C\) has an inverse (compression is lossless)&lt;/li&gt;
&lt;li&gt;The codes \(C(x)\) have minimal average length (good compression ratio).&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Shannon proved that such an optimal code would have an average code length essentially &lt;em&gt;equal to the entropy&lt;/em&gt; of the source.&lt;br&gt;
Moreover, he proved that for an optimal code, the code length \(\mid C(x) \mid\) would be &lt;em&gt;equal to the information content&lt;/em&gt; \(I(x)\).  In other words, if we define the &lt;em&gt;redundancy&lt;/em&gt; of our code \(C(x)\) as the difference \(\rho(x) = \mid C(x)\mid - I(x)\), then finding a good code is equivalent to minimizing the redundancy.&lt;br&gt;
Of course this is a bit sloppy; for more precise statements see e.g. &lt;a href=&#34;#references&#34;&gt;[2]&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&#34;arithmetic-coding&#34;&gt;Arithmetic Coding&lt;/h2&gt;
&lt;p&gt;Unsurprisingly, Shannon&amp;rsquo;s proof is non-constructive, so how do we make an optimal code in practice? Several algorithms have been developed. You make have heard of the Huffman code or Lempel-Ziv algorithm, which one can prove are roughly optimal. Less commonly known is &lt;em&gt;arithmetic coding&lt;/em&gt;.&lt;/p&gt;
&lt;p&gt;The nice thing about arithmetic coding is you can plug in any probabilistic model \(\mathcal{M}\) of the source (i.e. a way to generate predictions for the next symbol) and it guarantees you a code length approximately equal to the entropy according to your model \(H(X \mid \mathcal{M})\). The idea is to associate each sequence to a subinterval of \([0,1)\), whose length is equal to its probability.&lt;/p&gt;
&lt;p&gt;To illustrate the algorithm, suppose we are recieving a stream of binary data \(x_1,x_2,\dots,x_N\) (abbreviated \(x_1^N\)). Let \(L\) be the lower endpoint of the interval and \(U\) be the upper endpoint after receiving the \(n\)th symbol. Initially we have received no bits and set \(L=0\), \(U=1\).&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;L, U ⟵ 0, &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt;
For &lt;span class=&#34;nv&#34;&gt;n&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; 1...N &lt;span class=&#34;k&#34;&gt;do&lt;/span&gt;  
    generate prediction P&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;xn&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; 0&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
        &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;xn&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt;
            &lt;span class=&#34;k&#34;&gt;then&lt;/span&gt; L ⟵ L +  P&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;xn&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; 0&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;U-L&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
        &lt;span class=&#34;k&#34;&gt;else&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;xn&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; and U ⟵ U-P&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;xn&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; 1&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;*&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;U-L&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
        endif
endfor
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;At each step, we divide the current interval according to the probabilities of the next symbol. At the end, the compressed sequence is the sequence of binary digits of a number chosen from the interval \([L,U)\), (e.g. \(L\) rounded up).&lt;/p&gt;
&lt;p&gt;After \(n\) steps there are \(2^n\) subintervals, corresponding to the possible sequences \(x_1&amp;hellip;x_n\). For example after \(n=3\) the intervals might look like this:&lt;/p&gt;

&lt;link rel=&#34;stylesheet&#34; href=&#34;https://meiji163.github.io/css/hugo-easy-gallery.css&#34; /&gt;
&lt;div class=&#34;box&#34;&gt;
&lt;figure  itemprop=&#34;associatedMedia&#34;
  itemscope itemtype=&#34;http://schema.org/ImageObject&#34; &gt;
    &lt;div class=&#34;img&#34; data-size=&#34;900x400&#34;&gt;
      &lt;img itemprop=&#34;thumbnail&#34; src=&#34;https://meiji163.github.io/images/coding.png#center&#34; /&gt;
    &lt;/div&gt;
    &lt;a href=&#34;https://meiji163.github.io/images/coding.png#center&#34; itemprop=&#34;contentUrl&#34;&gt;&lt;/a&gt;
  &lt;/figure&gt;
&lt;/div&gt;

&lt;p&gt;Note that the length of the intervals are \(P(x_1\dots x_n) = P(x_1^n)\). A trivial model that predicts \(P(x_1^n) = 2^{-n}\) would essentially give us back the original sequence (a terrible compressor indeed) &amp;ndash; ideally our model assigns a larger probability to the sequence.&lt;/p&gt;
&lt;p&gt;That interval is guaranteed to contain a rational number \(c\) with approximately \(-\log( P(x_1^n))\) digits in its binary expansion, reducing the number of bits needed to describe it. The encoder can end the message either with a special &lt;code&gt;EOT&lt;/code&gt; symbol or by transmitting the length.&lt;/p&gt;
&lt;p&gt;Given the code \(c\) and access to the same model \(\mathcal{M}\), the decoder can sequentially deduce whether the \(n\)th bit was a 0 or 1 by comparing \(c\) to the divider \(L + P(x_n = 0)\cdot(U-L)\) and hence uniquely decode the compressed data.&lt;/p&gt;
&lt;p&gt;Arithmetic coding works the same way for non-binary alphabets, at each step dividing the interval into \(\mid\mathcal{A}\mid\) sections according to their probabilites.&lt;/p&gt;
&lt;h2 id=&#34;models&#34;&gt;Models&lt;/h2&gt;
&lt;p&gt;Assuming arithmetic coding can be implemented efficiently (see &lt;a href=&#34;#implementation-and-experiments&#34;&gt;below&lt;/a&gt;), we have reduced compression to finding a good model of the data. Of course, the model will depend a lot on what type of data you&amp;rsquo;re compressing and your speed/memory goals.&lt;/p&gt;
&lt;p&gt;The simplest model could just use frequency counts of the different symbols to make predictions. If you wanted to go all out you could train a neural net like an RNN or &lt;a href=&#34;https://en.wikipedia.org/wiki/Transformer_(machine_learning_model)&#34;&gt;transformer&lt;/a&gt; on your data to make the predictions. However you&amp;rsquo;d have to account for the size of the weights, which have to be sent the decoder. It would also be too slow for most purposes (although lightweight NN&amp;rsquo;s &lt;a href=&#34;http://mattmahoney.net/dc/mmahoney00.pdf&#34;&gt;achieve reasonable speed&lt;/a&gt;). Clearly there is a tradeoff between the complexity of the model and the compression ratio.&lt;/p&gt;
&lt;p&gt;A simpler option is a &lt;em&gt;tree model&lt;/em&gt;. We assume that \(P(x_n)\) depends on at most \(D\) of the previous symbols (in probability lingo, a \(D\)-Markov model).&lt;/p&gt;
&lt;p&gt;The main idea is to build a suffix tree (or trie) from the source. Given past symbols \(x_{n-D},&amp;hellip;,x_{n-1}\) (also known as the &lt;em&gt;context&lt;/em&gt;) we take the last \(k \le D\) as the suffix. We are free to choose \(k\), and it can vary between contexts.   We then record the frequencies of each symbol we observe after seeing a suffix.&lt;/p&gt;
&lt;p&gt;For example if the alphabet is \(\mathcal{A} = \text{ \{a ,b ,n\}}\) and the sequence &amp;ldquo;\(\text{bananan}\)&amp;rdquo; here is one possible depth \(D=2\) tree (suffixes are read from bottom up)&lt;/p&gt;


&lt;div class=&#34;box&#34;&gt;
&lt;figure  itemprop=&#34;associatedMedia&#34;
  itemscope itemtype=&#34;http://schema.org/ImageObject&#34; &gt;
    &lt;div class=&#34;img&#34; data-size=&#34;1024x900&#34;&gt;
      &lt;img itemprop=&#34;thumbnail&#34; src=&#34;https://meiji163.github.io/images/path12.png#center&#34; alt=&#34;A 2-Markov Model&#34;/&gt;
    &lt;/div&gt;
    &lt;a href=&#34;https://meiji163.github.io/images/path12.png#center&#34; itemprop=&#34;contentUrl&#34;&gt;&lt;/a&gt;
      &lt;figcaption&gt;
          &lt;p&gt;A 2-Markov Model&lt;/p&gt;
      &lt;/figcaption&gt;
  &lt;/figure&gt;
&lt;/div&gt;

&lt;p&gt;Each leaf has three counters (# \(\text{a}\)&amp;rsquo;s, # \(\text{b}\)&amp;rsquo;s , #\(\text{n}\)&amp;rsquo;s). E.g. &amp;ldquo;\(\text{n}\)&amp;rdquo; appears two times after the suffix &amp;ldquo;\(\text{na}\)&amp;rdquo;. A tree like this is called a &lt;em&gt;prediction suffix tree&lt;/em&gt; (PST). We can make rough estimates of the probability using the statistics stored in the leaves with e.g. a &lt;a href=&#34;https://en.wikipedia.org/wiki/Beta_distribution&#34;&gt;Beta distribution&lt;/a&gt;. Another common choice is the &lt;a href=&#34;https://en.wikipedia.org/wiki/Krichevsky%E2%80%93Trofimov_estimator&#34;&gt;Krichevsky-Trofimov estimator&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;A similar idea combined with the Lempel-Ziv algorithm forms the basis for the &amp;ldquo;Prediction by Partial Matching&amp;rdquo; algorithm, which is considered one of the top-performing tree models &lt;a href=&#34;#references&#34;&gt;[3]&lt;/a&gt;.&lt;/p&gt;
&lt;h2 id=&#34;context-tree-weighting&#34;&gt;Context Tree Weighting&lt;/h2&gt;
&lt;p&gt;Context Tree Weighting (CTW) is a beautiful algorithm invented by Willems, Shtarkov, and Tjalkens &lt;a href=&#34;#references&#34;&gt;[1]&lt;/a&gt; that efficiently computes a weighted sum over all prediction suffix trees of depth \(D\) for a binary alphabet. Naively, this would take \(O(2^D)\), while CTW computes it in \(O(D)\).&lt;/p&gt;
&lt;p&gt;We first build a complete binary tree of depth \(D\), called the context tree. Like a prediction suffix tree, each node is labeled by its corresponding suffix \(s\). Each node stores the frequencies of 0&amp;rsquo;s and 1&amp;rsquo;s that occur after suffix \(s\), and computes a probability \(P^s\) recursively from its children as follows: Let \(x_1\dots x_n\) be the past symbols, then the probability stored at the node \(s\) is defined as&lt;/p&gt;
&lt;p&gt;$$
P^s = \begin{cases}P_e(x_{1}^n) &amp;amp; \text{ if } s \text{ is a leaf }\cr
\frac{1}{2}\left(P_e(x_{1}^n) + P^{s0}P^{s1}\right)&amp;amp; \text{ otherwise.} \end{cases}
$$&lt;/p&gt;
&lt;p&gt;Here \(P_e\) is a probability estimate based on the frequencies stored at \(s\) (in the original paper it is the &lt;a href=&#34;https://en.wikipedia.org/wiki/Krichevsky%E2%80%93Trofimov_estimator&#34;&gt;KT estimator&lt;/a&gt;) and \(s0\), \(s1\) denote the children of \(s\).&lt;/p&gt;
&lt;p&gt;So we just average the frequency estimate with the predictions of the children nodes. Simple, right? But what is the probability we get at the root node, corresponding to the empty suffix \(\epsilon\)? Brace for notation&amp;hellip; it is&lt;/p&gt;
&lt;p&gt;$$
P^{\epsilon} = \sum_{T \in \mathcal{M}_D}2^{-\Gamma_D(T)}P(x_1^n \mid T)
$$&lt;/p&gt;
&lt;p&gt;where&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;\(\mathcal{M}_D\) is the set of all PST&amp;rsquo;s of depth at most \(D\)&lt;/li&gt;
&lt;li&gt;\(P(x_1^n \mid T)\) is the probability of \(x_1\dots x_n\) according to the PST \(T\)&lt;/li&gt;
&lt;li&gt;\(\Gamma_D(T)\) is the number of nodes of \(T\) minus the number of leaves at depth \(D\)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Well we certainly have a weighted sum of PST predictions, but what is this \(\Gamma_D\)? It is actually the length of the optimal &lt;a href=&#34;https://en.wikipedia.org/wiki/Prefix_code&#34;&gt;prefix code&lt;/a&gt; for the tree \(T\), i.e. the number of bits needed to describe \(T\). Thus each each prediction suffix tree is weighted by an Occam&amp;rsquo;s razor-like penalty.&lt;/p&gt;
&lt;p&gt;To make predictions with CTW we use the root probability, then update the path in the tree corresponding to the context when we receive the next symbol. The original paper proves a sharp bound on the redundancy of the code computed by CTW (Theorem 2).&lt;/p&gt;
&lt;h3 id=&#34;sidenote-compression--agi&#34;&gt;Sidenote: Compression = AGI?&lt;/h3&gt;
&lt;p&gt;Anyone into data compression probably knows about the &lt;a href=&#34;http://prize.hutter1.net/&#34;&gt;Hutter prize&lt;/a&gt;, a cash prize for compressing the first GB of Wikipedia to smaller than the current record (116 MB). Hutter&amp;rsquo;s slogan is &amp;ldquo;Compression = AGI,&amp;rdquo; a (rather exaggerated) summary of the principle behind &lt;a href=&#34;https://en.wikipedia.org/wiki/AIXI&#34;&gt;AIXI&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Roughly speaking, AIXI solves the general reinforcement learning problem by weighing models of the environment by both the expected reward &lt;em&gt;and&lt;/em&gt; a measure of the model&amp;rsquo;s complexity. In particular, the complexity is measured by the &lt;a href=&#34;https://en.wikipedia.org/wiki/Kolmogorov_complexity&#34;&gt;Kolmogorov complexity&lt;/a&gt; of the observation-reward sequence. (Hutter gives a fairly good non-technical explanation in &lt;a href=&#34;https://www.youtube.com/watch?v=E1AxVXt2Gv4&#34;&gt;this interview&lt;/a&gt;).&lt;/p&gt;
&lt;p&gt;Although theoretically optimal, the AIXI action function is infeasible to compute directly.&lt;br&gt;
What is so interesting about CTW is that the probability it computes is a mixture of models weighted by complexity (for a restricted set of models) &lt;em&gt;and&lt;/em&gt; it is efficient to compute. For this reason Veness et. al [&lt;a href=&#34;#references&#34;&gt;5&lt;/a&gt;] used CTW in their AIXI approximation algorithm. Other mixture models have also become popular in data compression algorithms (You can for example run several probability models in parallel).&lt;/p&gt;
&lt;h3 id=&#34;ctw-extensions&#34;&gt;CTW Extensions&lt;/h3&gt;
&lt;p&gt;The binary CTW can be extended to non-binary alphabets by replacing \(P^{s0}P^{s1}\) by a product over all children of \(s\) in the recursive formula. However the straightforward method of making direct predictions hasn&amp;rsquo;t had much empirical success, especially with large alphabets.&lt;/p&gt;
&lt;p&gt;In practice, CTW is good at making binary predictions, although it can still have non-binary contexts. How can we convert binary predictions to general symbol predictions?&lt;/p&gt;
&lt;p&gt;The obvious way to do this is to first choose a binary code for the alphabet \(\mathcal{A}\), then predict each bit. This is the idea behind a &amp;ldquo;decomposition tree,&amp;rdquo; which is basically a binary search tree. The leaves of the tree are the elements of \(\mathcal{A}\), and each internal node has a context tree (a tree of trees) whose job is to predict whether a symbol is in the left or right subtree of the node.&lt;/p&gt;
&lt;p&gt;The probability of a symbol \(a \in \mathcal{A}\) is then calculated as the product of the probabilities on the path from the root to the leaf \(a\).
For example, here is a possible decomposition tree for \(\mathcal{A} = \text{ \{b, a, n\}}\).&lt;/p&gt;


&lt;div class=&#34;box&#34;&gt;
&lt;figure  itemprop=&#34;associatedMedia&#34;
  itemscope itemtype=&#34;http://schema.org/ImageObject&#34; 
  style=&#34;max-width:450&#34; &gt;
    &lt;div class=&#34;img&#34;&gt;
      &lt;img itemprop=&#34;thumbnail&#34; src=&#34;https://meiji163.github.io/images/ctw.png#center&#34; alt=&#34;A decomposition tree with two context trees&#34;/&gt;
    &lt;/div&gt;
    &lt;a href=&#34;https://meiji163.github.io/images/ctw.png#center&#34; itemprop=&#34;contentUrl&#34;&gt;&lt;/a&gt;
      &lt;figcaption&gt;
          &lt;p&gt;A decomposition tree with two context trees&lt;/p&gt;
      &lt;/figcaption&gt;
  &lt;/figure&gt;
&lt;/div&gt;

&lt;p&gt;Context Tree 1 predicts whether the next symbol will be \(\text{b}\) or not, and context tree 2 decides between \(\text{a}\) and \(\text{n}\).&lt;/p&gt;
&lt;p&gt;One drawback of this approach is that the performance is sensitive to the topology of the decomposition tree. One choice is &lt;a href=&#34;https://en.wikipedia.org/wiki/Huffman_coding&#34;&gt;the Huffman tree&lt;/a&gt;, which minimizes the number of context trees updates that are required.&lt;/p&gt;
&lt;p&gt;In general we want to find groupings of the symbols which are &amp;ldquo;similar,&amp;rdquo; in some way. We could for example collect statistics on co-occurence of symbols à la &lt;a href=&#34;https://nlp.stanford.edu/projects/glove/&#34;&gt;GloVe&lt;/a&gt;. Once we decide on a decomposition tree, we have to describe it to the decompressor, but this is only a few more bytes overhead.&lt;/p&gt;
&lt;h2 id=&#34;implementation-and-experiments&#34;&gt;Implementation and Experiments&lt;/h2&gt;
&lt;p&gt;To experiment I wrote a &lt;a href=&#34;https://github.com/meiji163/ctwz&#34;&gt;simple implementation&lt;/a&gt; of CTW using a Huffman decomposition tree.&lt;/p&gt;
&lt;p&gt;The main difficulty in implementation is the precision of the probabilities. The original form of the arithmetic encoder requires arbitrary precision. To make it practical we can use finite precision and output a bit once the leading bits of \(U\) and \(L\) are equal. Then we scale the whole interval by \(2\). A more clever version of this scaling was invented by Witten, Neal, and Cleary &lt;a href=&#34;#references&#34;&gt;[6]&lt;/a&gt;, which is the version I used.&lt;/p&gt;
&lt;p&gt;The original CTW algorithm also needs modification. The main technique is to store a ratio of probabilities in the nodes to handle float-point errors. The exact method I used is the one described in &lt;a href=&#34;#references&#34;&gt;[4]&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;I tested my implementation with depth \(D=12\) on some text data from the &lt;a href=&#34;https://www.corpus.canterbury.ac.nz/&#34;&gt;Canterbury corpus&lt;/a&gt;. For comparison I also compressed the files with Unix&amp;rsquo;s &amp;ldquo;compress&amp;rdquo; and gzip on default settings. Both use variants of the Lempel-Ziv algorithm.&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style=&#34;text-align:center&#34;&gt;File&lt;/th&gt;
&lt;th style=&#34;text-align:center&#34;&gt;Size (Bytes)&lt;/th&gt;
&lt;th style=&#34;text-align:center&#34;&gt;Description&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;grammar.lsp&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;3721&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;LISP code&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;fields.c&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;11150&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;C code&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;plrabn12.txt&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;481861&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;Milton&amp;rsquo;s Paradise Lost&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;bible.txt&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;4047392&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;King James Bible&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;E.coli&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;4638690&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;Genome of E.Coli&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style=&#34;text-align:center&#34;&gt;Compression Ratio&lt;/th&gt;
&lt;th style=&#34;text-align:center&#34;&gt;ctw&lt;/th&gt;
&lt;th style=&#34;text-align:center&#34;&gt;compress&lt;/th&gt;
&lt;th style=&#34;text-align:center&#34;&gt;gzip&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;fields.c&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;4.21&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;2.24&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;3.55&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;grammar.lsp&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;3.65&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;2.05&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;2.99&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;plrabn12.txt&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;3.15&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;2.37&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;2.48&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;bible.txt&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;4.50&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;3.39&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;3.39&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;E.coli&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;4.09&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;3.69&lt;/td&gt;
&lt;td style=&#34;text-align:center&#34;&gt;3.56&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;It is interesting to look at the predictions CTW makes. It is particularly good at detecting basic structure like spaces between words, braces, parenthesis, etc. and repeated words and phrases. For example in fields.c consistently predicts ( \(p \approx 0.8\)) that function declarations like &lt;code&gt;realloc ()&lt;/code&gt; are followed by &lt;code&gt;;&lt;/code&gt; and that comments starting with &lt;code&gt;/*&lt;/code&gt; end with &lt;code&gt;*/&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;In &lt;code&gt;bible.txt&lt;/code&gt;, it is particularly good at predicting common words like &amp;ldquo;God&amp;rdquo; (big surprise). The probabilities for E.coli are actually rarely greater than \(0.3\). Since \(\mathcal{A} = \text{\{g, c, t, a\}}\) , the compression in this case is mainly due to the fact that the alphabet is small.&lt;/p&gt;
&lt;p&gt;We can see CTW is basically finding the &amp;ldquo;low hanging fruit&amp;rdquo; of redundancy. This is about all we can expect, since we know Markov models aren&amp;rsquo;t particularly good at learning grammatical structures.&lt;/p&gt;
&lt;p&gt;Although CTW compares favorably on these text files, my implementation failed miserably when I tried it on binary data (possible due to my janky code). My implementation is also 5-10 times slower than gzip and compress on large files, and undoubtedly uses much more memory.&lt;/p&gt;
&lt;p&gt;The good news is there is a lot of room for improvement. Obvious optimizations would be parallelizing the context trees and using fixed-point arithmetic instead of doubles. I highly recommend Volf&amp;rsquo;s thesis &lt;a href=&#34;#references&#34;&gt;[4]&lt;/a&gt;, in which he documents his CTW compressor project in great detail. He uses the previously mentioned optimizations (and many more) to satisfy a memory limit of 32MB and a compression speed of around 10kB/s.&lt;/p&gt;
&lt;h2 id=&#34;conclusion&#34;&gt;Conclusion&lt;/h2&gt;
&lt;p&gt;Context Tree Weighting is a beautiful example of a mixture model with &amp;ldquo;Occam&amp;rsquo;s-Razor&amp;rdquo; weighting. Its solid theoretical foundations make it attractive compared to e.g. Prediction by Partial Matching. However it is trickier to implement because of greater memory and computational requirements.&lt;/p&gt;
&lt;h2 id=&#34;references&#34;&gt;References&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://www.cs.cmu.edu/~aarti/Class/10704_Spring15/CTW.pdf&#34;&gt;[1]&lt;/a&gt; Willems, Shtarkov, Tjalkens &amp;ldquo;&lt;em&gt;The Context-Tree Weighting Method: Basic Properties&lt;/em&gt;&amp;rdquo; 1995&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://web.cs.iastate.edu/~honavar/infotheorybook.pdf&#34;&gt;[2]&lt;/a&gt; D. MacKay, &amp;ldquo;&lt;em&gt;Information Theory, Inference, and Learning Algorithms&lt;/em&gt;&amp;rdquo; 2003&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://www.jair.org/index.php/jair/article/view/10394&#34;&gt;[3]&lt;/a&gt; Begleiter, El-Yaniv, Yona, &amp;ldquo;&lt;em&gt;On Prediction Using Variable Order Markov Models&lt;/em&gt;&amp;rdquo; 2004&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://pure.tue.nl/ws/files/2043425/200213835.pdf&#34;&gt;[4]&lt;/a&gt; P. Volf, &amp;ldquo;&lt;em&gt;Weighting techniques in data compression: theory and algorithms&lt;/em&gt;&amp;rdquo; 2002&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://www.aaai.org/Papers/JAIR/Vol40/JAIR-4004.pdf&#34;&gt;[5]&lt;/a&gt; Veness, Siong Ng, Hutter, Uther, Silver &amp;ldquo;&lt;em&gt;A Monte-Carlo AIXI Approximation&lt;/em&gt;&amp;rdquo; 2011&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://dl.acm.org/doi/10.1145/214762.214771&#34;&gt;[6]&lt;/a&gt; Witten, Neal, Cleary &amp;ldquo;&lt;em&gt;Arithmetic Coding for Data Compression&lt;/em&gt;&amp;rdquo; 1987&lt;/p&gt;
</description>
      
    </item>
    
    <item>
      <title>Fast Sum of Two Squares Algorithm</title>
      <link>https://meiji163.github.io/post/sum-of-squares/</link>
      <pubDate>Sat, 23 Jan 2021 00:00:00 +0000</pubDate>
      
      <guid>https://meiji163.github.io/post/sum-of-squares/</guid>
      
        <description>&lt;p&gt;In this post I show how writing primes as the sum of two squares is related to factoring Gaussian integers. I then describe an algorithm to compute the sum of two squares representation.&lt;/p&gt;
&lt;h2 id=&#34;gaussian-integers&#34;&gt;Gaussian Integers&lt;/h2&gt;
&lt;p&gt;I have a special penchant for Gaussian integers because they are the first ring I learned about (besides the regular integers of course).
Mathematically, they are the set of complex numbers \(a+bi\) with \(a,b\) integers, and they are denoted as \(\mathbb{Z}[i]\).&lt;/p&gt;
&lt;p&gt;We can add, subtract, and multiply Gaussian integers making it into an algebraic structure called a &lt;strong&gt;ring&lt;/strong&gt;.
However, \(\mathbb{Z}[i]\) is a very special type of ring because it has a norm (which is just the square of the familiar Euclidean norm)&lt;/p&gt;
&lt;p&gt;$$N(a+bi) = a^2 + b^2.$$&lt;/p&gt;
&lt;p&gt;The norm allows us to do the Euclidean algorithm in \(\mathbb{Z}[i]\) in the same way as in the regular integers \(\mathbb{Z}\). This type of ring is called a &lt;a href=&#34;https://en.wikipedia.org/wiki/Euclidean_domain&#34;&gt;Euclidean domain&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;In other words, if we have two Gaussian integers \(z_1\) and \(z_2 \ne 0\), we can divide \(z_1\) by \(z_2\)&lt;/p&gt;
&lt;p&gt;$$z_1 = q z_2 + r$$&lt;/p&gt;
&lt;p&gt;where \(q,r \in \mathbb{Z}[i]\) and \(N(r) &amp;lt; N(z_2)\).&lt;/p&gt;
&lt;p&gt;If the remainder \(r = 0\), then we say \(z_1\) is divisible by \(z_2\). A &lt;strong&gt;Gaussian prime&lt;/strong&gt; is a Gaussian integer that
has no divisors except for itself, and the units \(\pm 1, \pm i\).
It is a theorem in algebra that every Euclidean domain has unique factorization, that is,
we can factor every Gaussian integer into Gaussian primes in a unique way&lt;/p&gt;
&lt;p&gt;Plotting the Guassian primes on the complex plane makes quite a pretty pattern.&lt;/p&gt;

&lt;link rel=&#34;stylesheet&#34; href=&#34;https://meiji163.github.io/css/hugo-easy-gallery.css&#34; /&gt;
&lt;div class=&#34;box&#34;&gt;
&lt;figure  itemprop=&#34;associatedMedia&#34;
  itemscope itemtype=&#34;http://schema.org/ImageObject&#34; &gt;
    &lt;div class=&#34;img&#34;&gt;
      &lt;img itemprop=&#34;thumbnail&#34; src=&#34;https://upload.wikimedia.org/wikipedia/commons/8/85/Gaussian_primes.png#center&#34; /&gt;
    &lt;/div&gt;
    &lt;a href=&#34;https://upload.wikimedia.org/wikipedia/commons/8/85/Gaussian_primes.png#center&#34; itemprop=&#34;contentUrl&#34;&gt;&lt;/a&gt;
  &lt;/figure&gt;
&lt;/div&gt;

&lt;p&gt;One thing you might wonder is how the familiar integer primes \(2,3,5,7,\dots\) are related to
the Gaussian primes.&lt;/p&gt;
&lt;p&gt;For example \(2 = (1+i)(1-i)\) so it is not a Guassian prime!
It turns out we can describe the relationship very simply:&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Theorem&lt;/strong&gt;:
Let \(p&amp;gt;2\) be an integer prime.
Then \(p\) is a Gaussian prime if and only if \(p \equiv 3 \pmod{4}\).&lt;/p&gt;
&lt;h2 id=&#34;sums-of-two-squares&#34;&gt;Sums of Two Squares&lt;/h2&gt;
&lt;p&gt;Factoring an integer in Gaussian integers is closely related to representing that integer as the sum of two squares.&lt;/p&gt;
&lt;p&gt;If we can factor \(p = (a+bi)(a-bi)\) then \(p = a^2 +b^2\). &lt;br&gt;
Moreover, if \(q = (c+di)(c-di)\) is also the sum of two squares, then so is \(pq\) since&lt;/p&gt;
&lt;p&gt;$$pq = ((ac-bd)+i(ad+bc))((ac-bd)-i(ac+bd)).$$&lt;/p&gt;
&lt;p&gt;From this we can determine all integers that can be represented as a sum of two squares
by looking at the primes in its prime factorization (in regular integers).&lt;/p&gt;
&lt;p&gt;For example, \(15 = 3\cdot 5\) is not the sum of squares because we can&amp;rsquo;t factor the \(3\) in Gaussian integers.&lt;/p&gt;
&lt;h3 id=&#34;the-algorithm&#34;&gt;The Algorithm&lt;/h3&gt;
&lt;p&gt;How can we efficiently factor primes in the Gaussian integers? Here is one
very fast way due to Serret and Hermite. Let \(p = 4k+1\) be prime.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Find a quadratic non-residue \(c \mod{p}\)&lt;/li&gt;
&lt;li&gt;Let \(x = c^{(p-1)/4} \mod{p}\) so that \(x^2 \equiv -1 \mod{p}\) (by &lt;a href=&#34;https://en.wikipedia.org/wiki/Euler%27s_criterion&#34;&gt;Euler&amp;rsquo;s criterion&lt;/a&gt; )&lt;/li&gt;
&lt;li&gt;Use the Euclidean algorithm on \(p\) and \(x\) until we get two remainders \(s,r &amp;lt; \sqrt{p}\) that satisfy \(p = r^2+s^2\).&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Recall that a quadratic residue mod \(p\) is an integer a such that \(a \equiv b^2 \mod{p}\) for some integer b&lt;sup id=&#34;fnref:1&#34;&gt;&lt;a href=&#34;#fn:1&#34; class=&#34;footnote-ref&#34; role=&#34;doc-noteref&#34;&gt;1&lt;/a&gt;&lt;/sup&gt;.&lt;/p&gt;
&lt;p&gt;Why does the algorithm work? The idea is to use a symmetry in the Euclidean algorithm.
In the Euclidean algorithm, we have a sequence of remainders \(r_0, r_1, r_2, \dots, r_n\) that end with the
greatest common divisor \(r_n = \gcd(r_0, r_1)\).&lt;/p&gt;
&lt;p&gt;We compute these recursively with initial values \(r_0=p, r_1=x\):&lt;/p&gt;
&lt;p&gt;$$r_{i-1} = q_{i}r_{i}+ r_{i+1} \quad \text{ where } q_i = \lfloor r_{i-1}/r_{i} \rfloor.$$&lt;/p&gt;
&lt;p&gt;We can define another sequence \((t_i)\) by the
same recurrence, but with initial values \(t_0 = 0\), \(t_1 = 1\):&lt;/p&gt;
&lt;p&gt;$$t_{i-1} = q_it_i + t{i+1} \quad \text{ where } q_i = \lfloor r_{i-1}/r_{i} \rfloor.$$&lt;/p&gt;
&lt;p&gt;It turns out that the \((t_i)\) sequence is just the reverse of the sequence \((r_i)\), up to signs.&lt;/p&gt;
&lt;p&gt;Moreover, one can see using the recurrence that \(t_i x \equiv r_i \pmod{p}\) for all i.&lt;br&gt;
Square this equation and use \(x^2 \equiv -1 \pmod{p}\) to get \(t_i^2 + r_i^2 \equiv 0 \pmod{p}\). &lt;br&gt;
From there we just need to find the \(t_i\) and \(r_i\) that are the right size so that \(t_i^2+r_i^2=p\).&lt;/p&gt;
&lt;p&gt;I encourage you to work out the details and try to prove it. (If you get stuck, most of the proof is in &lt;a href=&#34;https://www.jstor.org/stable/2323912&#34;&gt;this article&lt;/a&gt;)&lt;/p&gt;
&lt;h3 id=&#34;an-example&#34;&gt;An Example&lt;/h3&gt;
&lt;p&gt;To see the algorithm at work, take \(p=157\), and \(x=28\) (so that \(x^2 \equiv -1 \mod{p}\)).&lt;/p&gt;
&lt;p&gt;The sequences \((r_i), (t_i), (q_i)\) are as follows:&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;index&lt;/th&gt;
&lt;th&gt;r&lt;/th&gt;
&lt;th&gt;t&lt;/th&gt;
&lt;th&gt;q&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;0&lt;/td&gt;
&lt;td&gt;157&lt;/td&gt;
&lt;td&gt;0&lt;/td&gt;
&lt;td&gt;-&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;1&lt;/td&gt;
&lt;td&gt;28&lt;/td&gt;
&lt;td&gt;1&lt;/td&gt;
&lt;td&gt;5&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;2&lt;/td&gt;
&lt;td&gt;17&lt;/td&gt;
&lt;td&gt;-5&lt;/td&gt;
&lt;td&gt;1&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;3&lt;/td&gt;
&lt;td&gt;11&lt;/td&gt;
&lt;td&gt;6&lt;/td&gt;
&lt;td&gt;1&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;4&lt;/td&gt;
&lt;td&gt;6&lt;/td&gt;
&lt;td&gt;-11&lt;/td&gt;
&lt;td&gt;1&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;5&lt;/td&gt;
&lt;td&gt;5&lt;/td&gt;
&lt;td&gt;17&lt;/td&gt;
&lt;td&gt;1&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;6&lt;/td&gt;
&lt;td&gt;1&lt;/td&gt;
&lt;td&gt;-28&lt;/td&gt;
&lt;td&gt;5&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;7&lt;/td&gt;
&lt;td&gt;0&lt;/td&gt;
&lt;td&gt;157&lt;/td&gt;
&lt;td&gt;-&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;Notice the symmetry and the alternating sign of the t-sequence.&lt;br&gt;
Going to the middle of the sequence at index 3 or 4 we find \(11^2 + 6^2 = 157\).&lt;/p&gt;
&lt;h3 id=&#34;complexity-analysis&#34;&gt;Complexity Analysis&lt;/h3&gt;
&lt;p&gt;How fast is this algorithm given a prime p ?&lt;/p&gt;
&lt;p&gt;Step 3 of the algorithm (The Euclidean algorithm) is \(O(\log(p))\) by a &lt;a href=&#34;https://en.wikipedia.org/wiki/Euclidean_algorithm#Algorithmic_efficiency&#34;&gt;standard inductive argument&lt;/a&gt;.
The matter of finding a non-residue \(c\) is trickier to analyze.&lt;/p&gt;
&lt;p&gt;Assuming the &lt;a href=&#34;https://en.wikipedia.org/wiki/Generalized_Riemann_hypothesis#Extended_Riemann_hypothesis_(ERH)&#34;&gt;Generalized Riemann Hypothesis&lt;/a&gt; is true,
the theoretical upper bound on the least non-residue is \(2\log^2(p)\). In practice we rarely have to search more than \(\log(p).\) Quadratic resiudes and non-residues modulo a prime are &amp;ldquo;equally distributed,&amp;rdquo; but making this precise and proving it will lead you deep into number theory&lt;sup id=&#34;fnref:2&#34;&gt;&lt;a href=&#34;#fn:2&#34; class=&#34;footnote-ref&#34; role=&#34;doc-noteref&#34;&gt;2&lt;/a&gt;&lt;/sup&gt;.&lt;/p&gt;
&lt;p&gt;In any case, the total time complexity is \( O(\log^2(p)) \).&lt;/p&gt;
&lt;h2 id=&#34;implementation&#34;&gt;Implementation&lt;/h2&gt;
&lt;p&gt;To illustrate the algorithm, let&amp;rsquo;s sieve a bunch of primes then find their sum of two squares representation. Here&amp;rsquo;s a (slightly optimized)
&lt;a href=&#34;https://en.wikipedia.org/wiki/Sieve_of_Eratosthenes&#34;&gt;Sieve of Eratosthenes&lt;/a&gt; for sieving primes.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-c++&#34; data-lang=&#34;c++&#34;&gt;&lt;span class=&#34;c1&#34;&gt;// sieve of eratosthenes
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;std&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;::&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;vector&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;sieve&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;max&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;){&lt;/span&gt;
	&lt;span class=&#34;n&#34;&gt;std&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;::&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;vector&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;primes&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;};&lt;/span&gt;
	&lt;span class=&#34;n&#34;&gt;std&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;::&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;vector&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;bool&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;not_prime&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;max&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
	&lt;span class=&#34;kt&#34;&gt;bool&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;b&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;true&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
	&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;j&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;5&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
	&lt;span class=&#34;k&#34;&gt;while&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;max&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;){&lt;/span&gt;
		&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;not_prime&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;==&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;false&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;){&lt;/span&gt;
			&lt;span class=&#34;n&#34;&gt;primes&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;push_back&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
			&lt;span class=&#34;n&#34;&gt;a&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;b&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
			&lt;span class=&#34;n&#34;&gt;j&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
			&lt;span class=&#34;k&#34;&gt;while&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;j&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;max&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;){&lt;/span&gt;
				&lt;span class=&#34;n&#34;&gt;not_prime&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;j&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;true&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
				&lt;span class=&#34;n&#34;&gt;j&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;a&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;?&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;4&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
				&lt;span class=&#34;n&#34;&gt;a&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;!&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
			&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
		&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
		&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;b&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;?&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;4&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
		&lt;span class=&#34;n&#34;&gt;b&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;!&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;b&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
	&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
	&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;primes&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;To find c (the non-residue) we loop through the primes q that we found.&lt;br&gt;
Since \(p \equiv 1 \pmod{4}\), &lt;a href=&#34;https://en.wikipedia.org/wiki/Quadratic_reciprocity&#34;&gt;quadratic reciprocity&lt;/a&gt; implies that
\(q\) is a quadratic residue mod \(p\) if and only if \(p\) is a quadratic residue mod \(q\), which is much easier to check.
We can do this using Euler&amp;rsquo;s criterion.
&lt;!-- raw HTML omitted --&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-cpp&#34; data-lang=&#34;cpp&#34;&gt;&lt;span class=&#34;c1&#34;&gt;//find a quadratic non-residue mod p
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;non_residue&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;vector&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;primes&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;){&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;auto&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;it&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;primes&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;begin&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;it&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;!=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;primes&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;end&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;++&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;it&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;){&lt;/span&gt;
        &lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;q&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;it&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
        &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;q&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;==&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;){&lt;/span&gt; 
            &lt;span class=&#34;c1&#34;&gt;//2 is a quadratic residue iff p = 1 or -1 (mod 8)
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;            &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;%&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;8&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;!=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;7&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;%&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;8&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;!=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;  
                &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;q&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
        &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;else&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;q&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;==&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;){&lt;/span&gt; 
            &lt;span class=&#34;c1&#34;&gt;//3 is a quadratic residue iff p = 1 (mod 3)
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;            &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;%&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;==&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
                &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;q&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
        &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;else&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;!=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;q&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;){&lt;/span&gt; 
            &lt;span class=&#34;c1&#34;&gt;//use quadratic recprocity and Euler&amp;#39;s criterion
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;            &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;mod_pow&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;%&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;q&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;q&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;/&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;q&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;!=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
                &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;q&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;%&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; 
        &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;   
    &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;   
&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;I checked 2 and 3 separately but it&amp;rsquo;s not necessary.&lt;/p&gt;
&lt;p&gt;After that, we just need a function to do the Euclidean algorithm part.
(Note mod_pow is just fast mod p exponentiation)&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-cpp&#34; data-lang=&#34;cpp&#34;&gt;&lt;span class=&#34;c1&#34;&gt;//factor prime p = 4k + 1 in Gaussian integers
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;std&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;::&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;pair&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;gauss_factor&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;vector&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;primes&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;){&lt;/span&gt;
    &lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;b&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
    &lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;c&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;non_res&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;primes&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
    &lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;x&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;mod_pow&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;c&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;/&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;4&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;while&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;x&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;||&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;b&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;b&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;){&lt;/span&gt;
        &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;x&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;b&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;){&lt;/span&gt;
            &lt;span class=&#34;n&#34;&gt;x&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;%=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;b&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
        &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;else&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
            &lt;span class=&#34;n&#34;&gt;b&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;%=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
        &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;std&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;::&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;make_pair&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;b&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Testing on my junk laptop, it only took 2.07 seconds to factor all the primes below 1e8!
The best part is now we can enjoy long lists of primes as sums of squares. Soothing&amp;hellip;&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;	18413 = 118^2 + 67^2 
	18433 = 127^2 + 48^2 
	18457 = 36^2 + 131^2 
	18461 = 106^2 + 85^2 
	18481 = 16^2 + 135^2 
	18493 = 123^2 + 58^2 
	18517 = 119^2 + 66^2 
	18521 = 136^2 + 5^2 
	18541 = 125^2 + 54^2 
	18553 = 108^2 + 83^2 
	18593 = 47^2 + 128^2 
	18617 = 136^2 + 11^2 
	18637 = 94^2 + 99^2 
	18661 = 81^2 + 110^2 
	18701 = 115^2 + 74^2 
	18713 = 32^2 + 133^2 
	18749 = 43^2 + 130^2 
&lt;/code&gt;&lt;/pre&gt;&lt;h2 id=&#34;exercises-and-further-reading&#34;&gt;Exercises and Further Reading&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;Try to prove the Theorem (hint: the Norm is the key)! &lt;a href=&#34;https://kconrad.math.uconn.edu/blurbs/ugradnumthy/Zinotes.pdf&#34;&gt;Here&lt;/a&gt; are some excellent notes if you get stuck.&lt;/li&gt;
&lt;li&gt;Write a program that outputs the prime factorization of any Gaussian integer&lt;/li&gt;
&lt;li&gt;Gaussian integers are also related to Pythagorean Triples. Can you characterize which integers \(a\) satisfy \(a^2 =b^2 +c^2\) for some integers b and c?&lt;/li&gt;
&lt;li&gt;Another cool ring is the &lt;a href=&#34;https://en.wikipedia.org/wiki/Eisenstein_integer&#34;&gt;Eisenstein Integers&lt;/a&gt;. What are the Eisenstein integer primes? Can you factor Eisenstein integers efficiently?&lt;/li&gt;
&lt;/ul&gt;
&lt;section class=&#34;footnotes&#34; role=&#34;doc-endnotes&#34;&gt;
&lt;hr&gt;
&lt;ol&gt;
&lt;li id=&#34;fn:1&#34; role=&#34;doc-endnote&#34;&gt;
&lt;p&gt;. The terminology &amp;ldquo;residue&amp;rdquo; is a little funny (I&amp;rsquo;m reminded of the &lt;a href=&#34;https://www.math.purdue.edu/~eremenko/jokes.html&#34;&gt;joke&lt;/a&gt; about the dog Cauchy who leaves a residue at every pole). A better term would be &amp;ldquo;square mod p.&amp;rdquo;&amp;#160;&lt;a href=&#34;#fnref:1&#34; class=&#34;footnote-backref&#34; role=&#34;doc-backlink&#34;&gt;&amp;#x21a9;&amp;#xfe0e;&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li id=&#34;fn:2&#34; role=&#34;doc-endnote&#34;&gt;
&lt;p&gt;A classical result in this direction says that the &lt;a href=&#34;https://en.wikipedia.org/wiki/Dirichlet_density&#34;&gt;analytic density&lt;/a&gt; of squares mod p is \(1/2\).
A more recent and tighter result is by &lt;a href=&#34;https://www.cs.umd.edu/~gasarch/TOPICS/res/resperalta.pdf&#34;&gt;Peralta&lt;/a&gt;. He gives a precise bound on the deviation of the distribution of residues from a Bernoulli distribution.&amp;#160;&lt;a href=&#34;#fnref:2&#34; class=&#34;footnote-backref&#34; role=&#34;doc-backlink&#34;&gt;&amp;#x21a9;&amp;#xfe0e;&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/section&gt;
</description>
      
    </item>
    
    <item>
      <title>Liouville&#39;s Theorem on Conformal Rigidity</title>
      <link>https://meiji163.github.io/post/conformal-rigidity/</link>
      <pubDate>Sat, 23 Jan 2021 00:00:00 +0000</pubDate>
      
      <guid>https://meiji163.github.io/post/conformal-rigidity/</guid>
      
        <description>&lt;p&gt;In this post I summarize the content and proof of Liouville&amp;rsquo;s Theorem on Conformal Rigidity, which I learned in 2018 from Professor Alex Austin (now at RIT) in his class at UCLA.&lt;/p&gt;
&lt;h2 id=&#34;conformal-maps&#34;&gt;Conformal Maps&lt;/h2&gt;
&lt;p&gt;A conformal transformation is one that preserves angles. In two dimensions, this is equivalent to being holomorphic and having a non-vanishing derivative.
There are tons of these transformations (my personal favorites are Mobius transformations).
In fact, the famous &lt;a href=&#34;https://en.wikipedia.org/wiki/Riemann_mapping_theorem&#34;&gt;Riemann mapping Theorem&lt;/a&gt; asserts that any simply connected domain \( U \subset \mathbb{C} \) admits a bijective conformal map \(f: U \to \mathbb{D}\) to the unit disc.&lt;/p&gt;

&lt;link rel=&#34;stylesheet&#34; href=&#34;https://meiji163.github.io/css/hugo-easy-gallery.css&#34; /&gt;
&lt;div class=&#34;box&#34;&gt;
&lt;figure  itemprop=&#34;associatedMedia&#34;
  itemscope itemtype=&#34;http://schema.org/ImageObject&#34; &gt;
    &lt;div class=&#34;img&#34;&gt;
      &lt;img itemprop=&#34;thumbnail&#34; src=&#34;https://i.stack.imgur.com/c6nSk.jpg&#34; alt=&#34;A conformal map in the complex plane&#34;/&gt;
    &lt;/div&gt;
    &lt;a href=&#34;https://i.stack.imgur.com/c6nSk.jpg&#34; itemprop=&#34;contentUrl&#34;&gt;&lt;/a&gt;
      &lt;figcaption&gt;
          &lt;p&gt;A conformal map in the complex plane&lt;/p&gt;
      &lt;/figcaption&gt;
  &lt;/figure&gt;
&lt;/div&gt;

&lt;p&gt;In this note we will show that the only conformal maps in dimensions \(n \ge 3\) are built from inversions and reflections. It turns out that 2 dimensions is the exception!&lt;/p&gt;
&lt;p&gt;First, what exactly does &amp;ldquo;preserve angles&amp;rdquo; mean? The nicest way to talk about angles is via an inner product.
Given a vector space \(V\) with an inner product \(\langle \cdot, \cdot \rangle\), the angle \(\theta\) between two vectors \(v,w \in V\) is defined by&lt;/p&gt;
&lt;p&gt;$$ \cos \theta = \dfrac{ \langle v, w \rangle}{\sqrt{ \langle v,v \rangle \langle w, w \rangle}}.$$&lt;/p&gt;
&lt;p&gt;In Euclidean space with the standard inner product, this matches the formula you know. Thus a linear transformation \(A: V \to V\)
preserves angles if \(\langle Av, Aw \rangle = \lambda^2 \langle v, w \rangle\) for all \(v,w\) and some \(\lambda &amp;gt; 0\). Note that since \(\lambda^2 &amp;gt; 0\) we are requiring the orientation of the angle to be preserved as well.&lt;/p&gt;
&lt;p&gt;Thus a conformal linear transformation is just an orientation and distance preserving map (called a special orthogonal matrix)
followed by a dilation. Well, that&amp;rsquo;s pretty boring. But now we can define more general conformal maps by requiring its derivative to
be a conformal linear transformation!&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Definition&lt;/strong&gt;
Let \(U \subset \mathbb{R}^n\) be open. A \(C^1\) map \(f:U \to \mathbb{R}^n\). \(f\) is said to be &lt;strong&gt;conformal&lt;/strong&gt; if \(D_x f:T_xU \to T_{f(x)}\mathbb{R}^n\) is conformal for all \(x \in U\).&lt;/p&gt;
&lt;p&gt;(\(T_x)\) denotes the tangent space (plane) at \(x\) ).&lt;/p&gt;
&lt;h3 id=&#34;inversions-and-reflections&#34;&gt;Inversions and Reflections&lt;/h3&gt;
&lt;p&gt;A nice example of a conformal map is spherical inversion. Denote the one-point compactification \(\mathbb{R}^n \cup {\infty}\) of \(\mathbb{R}^n\) by \(\widehat{\mathbb{R}}^n\). Let \(S(a,r) \subset \mathbb{R}^n\) be the sphere of radius \(r\) with center \(a\). The inversion about \(S(a,r)\) is defined as&lt;/p&gt;
&lt;p&gt;$$\varphi_{a,r}(x) = a + r\frac{x-a}{|x-a|^2}, \quad x \ne a,\infty$$&lt;/p&gt;
&lt;p&gt;and \(\varphi_{a,r}(a) = \infty\), \(\varphi_{a,r}(\infty) = a.\)&lt;/p&gt;
&lt;p&gt;\(\varphi_{r,a}\) swaps the interior and exterior of the sphere and fixes \(S(a,r)\). One can check that \(\varphi_{a,r}\) is an involution, i.e. \(\varphi_{a,r} \circ \varphi_{a,r} = \text{id}.\)&lt;/p&gt;
&lt;p&gt;We can verify that \(\varphi_{a,r}\) is conformal with direct computation.
First consider \(\varphi = \varphi_{0,1}\). We calculate that&lt;/p&gt;
&lt;p&gt;$$D_x \varphi = \frac{1}{|x|^2}( I - 2 Q_x )$$&lt;/p&gt;
&lt;p&gt;where \(Q\) is the symmetric matrix with entries \(\dfrac{x_i x_j}{|x|^2}\).
Note that \(Q\) satisfies \(Q^2=Q\) since&lt;/p&gt;
&lt;p&gt;$$\begin{aligned}
Q^2_{ij} &amp;amp;= \sum_{k=1}^n \frac{x_k x_j}{|x|^2} \frac{x_i x_k}{|x|^2}\cr
&amp;amp;= \left( \sum_{k=1}^n\frac{x_k^2}{|x|^2}\right)\frac{x_i x_j}{|x|^2} = \frac{x_i x_j}{|x|^2}.
\end{aligned}$$&lt;/p&gt;
&lt;p&gt;Hence we get \((D_x\varphi)^T D_x \varphi = \frac{1}{|x|^4}(I-4Q-x+4Q_x^2) = \frac{1}{|x|^4}I\) so \(\varphi\) is conformal.
For general \(\varphi_{r,a}\), we use an affine transformation \(\psi(x) = rx +a\), which is obviously conformal.
Then \(\varphi_{r,a}=\psi \circ \varphi \circ \psi^{-1}\) is also conformal.&lt;/p&gt;
&lt;p&gt;Another type of transformation we will need is reflections.
Fix \(a \in \mathbb{R}^n\) and \(s&amp;gt;0\) and let \(P(a,s) = \{x \in \mathbb{R}^n| a \cdot x =s\} \cup \{\infty\} \) be the corresponding plane in \(\widehat{\mathbb{R}}^n\). The reflection in \(P(a,s)\) is defined as&lt;/p&gt;
&lt;p&gt;$$r_{a,s}(x) = x-2(a \cdot x -s) \frac{a}{|a|^2}, \qquad x \in \mathbb{R}^n$$&lt;/p&gt;
&lt;p&gt;and \(r_{a,s}(\infty) =\infty\). We define a Mobius transformation on \(\widehat{\mathbb{R}}^n\) for \(n\ge 3\)
as a finite composition of reflections in planes and inversions about spheres.&lt;/p&gt;
&lt;h2 id=&#34;liouvilles-theorem&#34;&gt;Liouville&amp;rsquo;s Theorem&lt;/h2&gt;
&lt;p&gt;Now we can precisely state what we want to prove.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Liouville&amp;rsquo;s Theorem&lt;sup id=&#34;fnref:1&#34;&gt;&lt;a href=&#34;#fn:1&#34; class=&#34;footnote-ref&#34; role=&#34;doc-noteref&#34;&gt;1&lt;/a&gt;&lt;/sup&gt;&lt;/strong&gt;: Let \(U \subset \mathbb{R}^n\) be open with \(0 \in U\) and \(n \ge 3\). &lt;br&gt;
If \(f:U \to \mathbb{R}^n\) is \(C^4\) and conformal, then \(f\) is the restriction of a Mobius transformation.&lt;/p&gt;
&lt;p&gt;Actually, the theorem holds for much lower regularity, but we assume \(C^4\) for simplicity. The strategy we will use is to
study vector fields whose flow is conformal. The &lt;strong&gt;flow&lt;/strong&gt; of a \(v\) is a function \(f_t\) parametrized by time that satisfies&lt;/p&gt;
&lt;p&gt;$$\begin{aligned}
f_0(x) &amp;amp;= x\cr
\frac{d}{dt}f_t(x) &amp;amp;= v(f_t(x))\end{aligned}$$&lt;/p&gt;
&lt;p&gt;for every \(x\). The point \(x\) is &amp;ldquo;flowing down the river&amp;rdquo; determined by the vector field (for this reason I&amp;rsquo;ve heard the &lt;a href=&#34;https://en.wikipedia.org/wiki/Lie_derivative&#34;&gt;Lie derivative&lt;/a&gt; called the &amp;ldquo;fisherman&amp;rsquo;s derivative&amp;rdquo;!)
The idea is to transfer the problem of characterizing conformal maps into  a problem about vector fields and differential equations.
This tactic can be applied in many other problems!&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Lemma&lt;/strong&gt;
Let \(v:\mathbb{R}^n \to \mathbb{R}^n\) be a \(C^1\) vector field. Then the flow of \(v\) is conformal if and only if
$$(Dv)^T+Dv = \frac{2}{n} \operatorname{tr}(Dv) I.$$&lt;/p&gt;
&lt;p&gt;&lt;em&gt;Proof&lt;/em&gt;: Let \(f_t\) be the local flow of \(v\) and \(p \in \mathbb{R}^n\). For convenience set \(A=D_p f_t\), \(B=D_{f_t(p)}v\). We differentiate the relation&lt;br&gt;
$$A^T A = (\det A)^{2/n} ; I$$
with respect to \(t\) and use &lt;a href=&#34;https://en.wikipedia.org/wiki/Jacobi%27s_formula&#34;&gt;Jacobi&amp;rsquo;s formula&lt;/a&gt; to obtain&lt;/p&gt;
&lt;p&gt;$$\begin{aligned} A^TB^TA+A^TBA &amp;amp;= \frac{2}{n}(\det (A))^{2/n -1} \det A \operatorname{tr} \left(A^{-1} \frac{dA}{dt}\right)\cr
&amp;amp;=\frac{2}{n} (\det A)^{2/n} \operatorname{tr} (B) I.\end{aligned}$$&lt;/p&gt;
&lt;p&gt;Multiplying by \((A^T)^{-1}\) on the left and \(A^{-1}\) on the right we&amp;rsquo;re left with
$$\begin{aligned} B^T+B &amp;amp;= \frac{2}{n}(\det A)^{2/n} \operatorname{tr} (B) \underbrace{(A^T)^{-1}A^{-1}}_{=(AA^T)^{-1}}\cr
&amp;amp;= \frac{2}{n} \operatorname{tr}(B) I\end{aligned}$$&lt;/p&gt;
&lt;p&gt;as desired. \(\blacksquare\)&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Theorem&lt;/strong&gt;
If the flow of \(v\) is conformal, then \(v\) is of the form&lt;/p&gt;
&lt;p&gt;$$v(x) = a+Bx+2(c \cdot x)x-|x|^2 c$$&lt;/p&gt;
&lt;p&gt;for some \(c\in \mathbb{R}^n\), where \(B\in M_{n \times n}\) satisfies \(B+B^T = \frac{2}{n} \operatorname{tr}(B) I_n\).&lt;/p&gt;
&lt;p&gt;&lt;em&gt;Proof&lt;/em&gt;: Using the lemma we get \(\partial_i v_i = \partial_j v_j\)  for all \(i,j\)
and \(\partial_i v_j = - \partial_j v_i\) for all \(i \ne j\). By repeatedly using these facts we can deduce that all third order partial derivatives of \(v\) vanish.
Therefore,&lt;/p&gt;
&lt;p&gt;$$v_i(x) = a_i + \sum_j b_{ij}x_j + \sum_{j,k} c_{ijk}x_jx_k$$&lt;/p&gt;
&lt;p&gt;for some coefficients \(c_{ijk}\) such that \(c_{ijk}=c_{ikj}\). Next we calculate&lt;/p&gt;
&lt;p&gt;$$\begin{aligned} \partial_i v_i(x) &amp;amp;= b_j + 2 \sum_{k} c_{ijk}x_k\cr
\partial_k \partial_j v_i(x)&amp;amp; = 2c_{ijk}\end{aligned}$$&lt;/p&gt;
&lt;p&gt;We know \(c_{iik}=c_{jjk}\) for all \(i,j\) so set \(c_k:=c_{iik}\) and \(c = (c_1,\dots,c_n\)). Using the symmetries again we get \(c_{ikk} = -c_{kik} = -c_{kki}=-c_i\).
Now we can rewrite \(v_i\) as&lt;/p&gt;
&lt;p&gt;$$\begin{aligned}
v_i(x) &amp;amp;= a_i + \sum_{j}b_{ij} x_j + 2 \left(\sum_k c_k x_k \right)x_i -c_i \sum_{k}x^k \cr
&amp;amp;=a_i +\sum_{j} b_{ij}x_j + 2(c \cdot x) x_i -|x|^2 c_i\end{aligned}$$&lt;/p&gt;
&lt;p&gt;Combining the equations for \(i=1,2,\dots,n\) we get what we want. \(\blacksquare\)&lt;/p&gt;
&lt;p&gt;Let \(v(x) =e_j\) and \(\varphi_t(x) = x+te_j\) its flow, where \(e_j\) is the \(j\)th standard basis vector.
Let \(g=f^{-1}\) and consider \(h_t=g \circ \varphi_t \circ f : V \to U\), with \(V \subset U\) chosen so that \(\varphi_t(f(V)) \subset f(U)\). Then we have&lt;/p&gt;
&lt;p&gt;$$\frac{d}{dt}h_t(x) = D_{f(h_t(x))}g \cdot v(f(x)).$$&lt;/p&gt;
&lt;p&gt;We conclude \(h_t\) is the flow of the vector field \(w(x) =D_{f(x)}g \cdot v(f(x))\).
Now we can execute our plan to prove Liouville&amp;rsquo;s theorem.&lt;/p&gt;
&lt;p&gt;&lt;em&gt;Proof of Liouville&lt;/em&gt;:
By composing with an affine map we can assume \(f(0)=0\) and  \(D_0f =I\).
Set \(\varphi = \varphi_{0,1}\) as before and define \(G = \varphi \circ f\), which is conformal on \(U\). It suffices to show that \(G\) is a M&amp;quot;obius trasformation. We will embed \(G\) in the flow of \(v = (DG)^{-1}e_i.\) We get&lt;/p&gt;
&lt;p&gt;$$\begin{aligned}
D_xG &amp;amp;= D_{f(x)}\varphi D_x f\cr
&amp;amp;= \frac{1}{|f(x)|^2}(I-2Q_{f(x)})D_x f\end{aligned}$$&lt;/p&gt;
&lt;p&gt;We know \((I-2Q_x)^2 = I,\) so \((I-2Q_x)^{-1} = I-2Q_x\). With this we can calculate&lt;/p&gt;
&lt;p&gt;$$\begin{aligned}
(D_xG)^{-1}e_i &amp;amp;= (D_x f)^{-1}(D_{f(x)}\varphi)^{-1}e_i\cr
&amp;amp;= (D_xf)^{-1} \cdot |f(x)|^2 (I -2Q_{f(x)})e_i\cr
&amp;amp;= |f(x)|^2 (D_xf)^{-1}e_i - 2(f(x) \cdot e_i)
\end{aligned}$$&lt;/p&gt;
&lt;p&gt;Using the Theorem on conformal vector fields, we can write
\((D_x G)^{-1}e_i = a+Bx +2(c\cdot x)x-|x|^2c.\)&lt;/p&gt;
&lt;p&gt;\(f(0)=0\) implies \((D_0G)^{-1}e_i = 0\), so \(a=0\). We contend that \(B \equiv 0\) as well.
Let \(u \in \mathbb{R}^n\) be unit length, and \(\epsilon&amp;gt;0\). We consider  \(\epsilon B(u)\) as \(\epsilon \to 0\):&lt;/p&gt;
&lt;p&gt;$$\begin{aligned}
B( \epsilon u) &amp;amp;= (D_{\epsilon u}G)^{-1}e_i-2(c \cdot \epsilon u) \epsilon u - |\epsilon u|^2c\cr
&amp;amp;= |f(\epsilon u)|^2(D_{\epsilon u}f)^{-1}\left(I-2Q_{f(\epsilon u)}\right)e_i -\epsilon^2((c\cdot u)u -c)\cr
&amp;amp;= \epsilon^2 \left| u + \frac{o(\epsilon)}{\epsilon}\right| (D_{\epsilon u}f)^{-1}\left(I-2Q_{f(\epsilon u)}\right)e_i -\epsilon^2((c\cdot u)u -c)
.\end{aligned}$$&lt;/p&gt;
&lt;p&gt;where we used linear approximation \(f(x) = x+ o(|x|)\). Dividing through by \(\epsilon\),
the LHS is independent of \(\epsilon\) while the RHS has a factor of \(\epsilon\). As \(\epsilon \to 0\), the RHS converges to \(0\).
Consequently, we must have \(B \equiv 0\), which proves the contention. To find \(c\) we use the same argument with \(x = \epsilon c\) to get&lt;/p&gt;
&lt;p&gt;$$|c|^2c = \left|c + \frac{o(|\epsilon c|)}{|\epsilon c|}|c| \right|^2(D_{\epsilon c}f)^{-1}(I-2Q_{c})e_i$$&lt;/p&gt;
&lt;p&gt;We can write \(Q_{f(\epsilon c)}=Q_{\epsilon c} + E(s)\) where \(E(s) \to 0\) as \(s\to 0\) (in the space of matrices). Therefore \(|c|^2c = |c|^2(I-2Q_{c})e_i\).
Solving for \(e_i\) we have&lt;/p&gt;
&lt;p&gt;$$e_i = (E-2Q_c)c = c-2\frac{c\cdot c}{|c|^2}c = -c.$$&lt;/p&gt;
&lt;p&gt;We have shown that
$$\begin{aligned}
(D_xG)^{-1}e_i &amp;amp;= - 2(e_i \cdot x)x - |x|^2e_i\cr
&amp;amp;=|x|^2(I-2Q_x)e_i\cr
&amp;amp;= (D_x \varphi)^{-1}e_i
\end{aligned}$$&lt;/p&gt;
&lt;p&gt;Thus we conclude that \(D_x G = D_x \varphi.\) Hence \(f(x) = \varphi(\varphi(x) +d)\) for some constant \(d\in \mathbb{R}^n,\)
which is indeed a Mobius transformation. \(\blacksquare\)&lt;/p&gt;
&lt;section class=&#34;footnotes&#34; role=&#34;doc-endnotes&#34;&gt;
&lt;hr&gt;
&lt;ol&gt;
&lt;li id=&#34;fn:1&#34; role=&#34;doc-endnote&#34;&gt;
&lt;p&gt;You may have heard of Liouville&amp;rsquo;s Theorem from complex analysis that says every bounded entire function is constant. Many rigidity results of this type are called &amp;ldquo;Liouville Theorems&amp;rdquo;&amp;#160;&lt;a href=&#34;#fnref:1&#34; class=&#34;footnote-backref&#34; role=&#34;doc-backlink&#34;&gt;&amp;#x21a9;&amp;#xfe0e;&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/section&gt;
</description>
      
    </item>
    
  </channel>
</rss>
